3dl
############################################################################
# File automatically generated by the 3delight shader compiler.            #
# DO NOT EDIT THIS FILE !!!                                                #
############################################################################

# Compiled with 3Delight 11.0.4 win64 (Oct 11 2013, 9c14e5) "Berto Durante"

%code 7 121
3

0
0
0
0
1
0
0
0
0
1
1
0
0
0
0
0
0
1
1
1
1
1
1
0
0
0
0
0
37
0 12 0
0 4 ""
0 4 "Sides"
0 4 "geometry:geometricnormal"
0 4 "Ri:Orientation"
0 4 "outside"
0 1 3.00000000e+000
0 1 4.00000000e+000
0 4 "type"
0 4 "world"
0 1 3.00000012e-001
0 1 0.00000000e+000
0 1 5.89999974e-001
0 1 1.00000000e+000
0 1 1.09999999e-001
0 1 2.00000000e+000
0 1 6.40000000e+001
0 1 9.99999962e+035
0 4 "cosine"
0 4 "light"
0 4 "environment:"
0 4 "environment:color"
0 4 "environment:direction"
0 4 "environment:solidangle"
0 1 1.00000005e-003
0 1 9.99999978e-003
0 1 6.55340000e+004
0 4 "user:bake_file"
0 4 "user:maya_ptc_maxsolidangle"
0 4 "photon:globalmap"
0 4 "both"
0 4 "diffuse"
0 1 3.18309873e-001
0 1 1.57079637e+000
0 1 3.33333343e-001
0 1 7.95774683e-002
0 1 1.59154937e-001
27
"effect" "" 2 1 0 0 0 0
"color_bleeding_intensity" "" 2 1 0 0 0 0
"black_point" "rgb" 2 3 0 0 0 0
"white_point" "rgb" 2 3 0 0 0 0
"samples" "" 2 1 0 0 0 0
"maxdist" "" 2 1 0 0 0 0
"distribution" "" 2 4 0 0 0 0
"envmap" "" 2 4 0 0 0 0
"envspace" "" 2 4 0 0 0 0
"falloffmode" "" 2 1 0 0 0 0
"falloff" "" 2 1 0 0 0 0
"environment_intensity" "" 2 1 0 0 0 0
"environment_color_gain" "rgb" 2 3 0 0 0 0
"environment_color_offset" "rgb" 2 3 0 0 0 0
"environment_casts_shadows" "" 2 1 0 0 0 0
"only_aovs" "" 2 1 0 0 0 0
"point_based_bias" "" 2 1 0 0 0 0
"use_deprecated_gi" "" 2 1 0 0 0 0
"__nondiffuse" "" 2 1 0 0 0 0
"__nonspecular" "" 2 1 0 0 0 0
"__category" "" 2 4 0 0 0 0
"__3dfm_shadowing" "" 3 1 0 0 1 0
"__3dfm_unshadowed_cl" "rgb" 3 3 0 0 1 0
"__occlusion" "" 3 1 0 0 1 0
"__visibility" "rgb" 3 3 0 0 1 0
"__environment_diffuse" "rgb" 3 3 0 0 1 0
"__color_bleeding" "rgb" 3 3 0 0 1 0
0
0
0
0
0
0
0
0


3

1 65 41 

1
3 

3

1 66 41 

1
3 

3

4 67 39 

1
3 

3

4 68 39 

1
3 

3

1 69 44 

1
3 

3

1 70 45 

1
3 

3

7 71 46 

1
3 

3

7 72 29 

1
3 

3

7 73 37 

1
3 

3

1 74 39 

1
3 

3

1 75 41 

1
3 

3

1 76 41 

1
3 

3

4 77 41 

1
3 

3

4 78 39 

1
3 

3

1 79 39 

1
3 

3

1 80 39 

1
3 

3

1 81 52 

1
3 

3

1 82 39 

1
3 

3

1 83 39 

1
3 

3

1 84 41 

1
3 

3

7 85 29 

1
3 

3

1 86 39 

1
3 

3

4 87 39 

1
3 

3

1 88 39 

1
3 

3

4 89 41 

1
3 

3

4 90 39 

1
3 

3

4 91 39 

1
3 

0
0

0

0

0

0

1
"light"
9
4
22
19
20
18
17
21
9
10
2
"*L" 3 8 0 0 1 0
"*Cl" 3 3 0 0 1 0
0
0

0


0

0


0

8
4 0 0 0
4 0 0 0
10 0 0 0
1 0 0 0
1 0 0 0
1 0 0 0
3 0 0 0
12 0 0 0
20
10 0 0 0
10 0 0 0
10 0 0 0
1 0 0 0
1 0 0 0
1 0 0 0
1 0 0 0
1 0 0 0
3 0 0 0
3 0 0 0
8 0 0 0
9 0 0 0
9 0 0 0
8 0 0 0
2 0 0 0
8 0 0 0
2 0 0 0
2 0 0 0
2 0 0 0
8 0 0 0
948

9 19 39 39 39 
9 18 39 39 39 
9 20 41 41 41 
7 92 29 
203 95 36 92 
43 94 65 39 
232 94 0 3 
4 19 39 
233 912 
45 100 92 47 
232 100 0 154 
42 100 43 65 
232 100 0 4 
46 100 72 29 
234 
232 100 0 4 
41 100 39 76 
234 
232 100 0 127 
170 2 92 48 72 
4 110 39 
4 108 39 
1 103 39 
135 115 110 1 
9 116 39 39 39 
220 116 117 118 
180 92 116 117 118 115 39 69 99 13 28 28 28 28 28 28 28 28 28 28 28 28 28 3 51 50 49 103 110 108 
181 99 101 102 3 103 110 108 
235 101 57 
232 102 0 50 
12 110 110 73 
40 119 110 
24 104 103 64 
20 105 41 104 
62 106 105 
175 100 17 119 106 18 
232 100 0 21 
26 109 108 77 
19 19 109 78 
24 95 76 63 
25 19 19 95 
176 17 18 19 106 
234 
234 
236 -68 
182 99 
234 
233 747 
4 19 39 
1 88 39 
4 89 41 
4 90 39 
4 91 39 
135 110 21 1 
2 112 110 
1 95 43 
200 96 30 95 
43 100 95 43 
232 100 0 4 
139 112 110 4 
233 32 
1 95 41 
200 96 31 95 
43 102 95 39 
232 102 0 16 
200 97 32 93 
45 101 93 33 
232 101 0 3 
40 112 112 
234 
234 
234 
2 111 112 
7 93 71 
46 100 72 29 
232 100 0 4 
43 100 65 34 
234 
232 100 0 4 
44 100 79 39 
234 
232 100 0 3 
7 93 72 
234 
7 92 29 
1 97 53 
201 96 55 92 
201 95 56 97 
19 118 17 112 
173 100 118 28 28 17 18 
232 100 0 605 
43 102 65 54 
232 102 0 39 
7 92 29 
200 96 57 92 
46 101 92 29 
232 101 0 18 
2 117 17 
220 117 116 115 
168 3 19 92 117 110 28 28 41 116 115 
233 3 
4 19 39 
234 
233 550 
43 101 65 41 
232 101 0 126 
2 115 17 
220 115 116 117 
163 37 88 115 111 69 28 28 70 28 28 28 73 28 28 28 93 28 28 28 28 28 75 74 28 28 28 28 41 28 28 28 28 28 28 28 28 28 28 28 28 28 28 116 117 
20 103 41 88 
4 89 103 
153 89 67 68 89 
42 100 80 39 
232 100 0 53 
41 100 39 82 
232 100 0 36 
2 87 68 
21 109 41 89 
126 103 109 
24 106 38 103 
127 105 109 
24 104 40 105 
17 103 106 104 
128 104 109 
24 105 42 104 
17 86 103 105 
233 6 
2 87 89 
2 19 87 
234 
234 
233 413 
43 100 65 43 
232 100 0 52 
46 100 72 29 
232 100 0 43 
15 112 111 73 
135 117 112 1 
167 109 72 117 
26 90 77 109 
19 90 90 78 
24 95 76 60 
25 90 90 95 
42 100 80 39 
232 100 0 6 
2 87 90 
2 19 90 
234 
234 
233 350 
41 100 39 66 
232 100 0 341 
1 107 39 
4 108 39 
43 100 65 35 
232 100 0 55 
1 95 61 
2 117 17 
220 117 116 115 
164 37 109 117 111 39 95 81 70 28 28 72 73 108 28 107 28 28 28 92 28 58 28 28 97 41 28 41 28 28 28 37 28 28 41 28 28 28 28 28 28 28 28 116 115 
233 150 
41 100 39 82 
232 100 0 52 
2 115 17 
220 115 116 117 
164 37 109 115 111 69 28 28 70 28 28 72 73 108 28 107 93 28 28 28 28 28 75 74 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 116 117 
233 87 
25 98 77 76 
2 117 17 
220 117 116 115 
2 114 111 
220 114 113 119 
162 25 109 117 114 28 69 28 70 28 28 28 28 59 28 89 28 46 28 28 28 72 73 98 28 28 28 90 28 28 28 116 115 113 119 
23 91 109 90 
126 105 89 
127 104 89 
17 103 105 104 
128 104 89 
17 105 103 104 
24 106 105 62 
20 88 41 106 
153 89 67 68 89 
234 
234 
41 100 39 82 
232 100 1 4 
43 100 65 35 
234 
232 100 0 35 
23 91 109 108 
25 91 91 66 
1 88 107 
26 109 77 108 
19 90 109 78 
25 90 90 76 
20 106 41 88 
4 89 106 
153 89 67 68 89 
234 
42 100 80 39 
232 100 0 57 
41 100 39 82 
232 100 0 39 
2 87 90 
21 109 41 89 
126 106 109 
24 105 38 106 
127 104 109 
24 103 40 104 
17 104 105 103 
128 105 109 
24 103 42 105 
17 86 104 103 
2 19 90 
233 7 
19 87 90 91 
2 19 87 
234 
234 
234 
234 
234 
234 
174 17 18 19 28 
234 
234 
234 

227
5 10 15 18 22 26 30 33 35 39 43 47 51 55 56 60 64 65 69 74 
77 80 83 87 92 96 126 134 137 141 145 148 152 156 159 165 169 173 177 181 
185 190 191 192 194 196 197 199 202 205 208 211 214 218 221 224 228 232 236 240 
242 245 249 253 257 261 265 269 272 273 274 275 278 281 285 289 293 294 298 302 
303 307 310 311 314 317 321 325 329 336 340 344 348 351 355 359 363 366 370 381 
383 386 387 389 393 397 400 404 449 453 456 461 465 469 473 477 480 484 487 491 
494 498 502 505 509 513 515 518 521 522 523 525 529 533 537 541 545 549 553 557 
561 565 569 573 577 580 583 584 585 587 591 595 598 601 605 609 612 615 619 664 
666 670 674 677 681 726 728 732 735 739 742 746 781 785 788 791 795 798 802 806 
810 815 816 817 821 825 829 830 834 838 842 845 849 853 857 861 864 869 870 874 
878 882 886 889 893 896 900 903 907 911 914 918 922 925 927 931 934 935 936 937 
938 939 940 945 946 947 948 

%comment-3dl 7 121
4
"MacroBlocks_light"
"MTUKMCAzCiAwIDAgMwogMTkgMjAgMTgKMTUgMwogMSAxIDAKIDc2IDEwMAoyMCA1CiAwIDAgNQogMTAzIDEwOCAxMTAgMTE1IDExNgozMSA0CiAyIDAgMgogMTAzIDExMCAxMDYgMTE5CjM3IDQKIDQgMCAxCiAxMDggNzYgNzcgNzggMTkKNDggOAogMSA0IDQKIDIxIDg4IDg5IDkwIDkxIDk1IDExMCAxMTIgMTkKNjcgMwogMSAxIDAKIDEwMSAxMTIKNzUgNgogMiAxIDAKIDY1IDc5IDEwMAoxMDkgMjIKIDUgNCAwCiA2NyA2OCA4MCA4MiA4OCAxOSA4NiA4NyA4OQoxMzkgOQogNSAzIDAKIDEwOSA3NiA3NyA3OCA4MCAxOSA4NyA5MAoxNTIgMwogMSAwIDMKIDY1IDEwMCAxMDcgMTA4CjE1NiAyCiAxIDAgMgogMTcgOTUgMTE3CjE2NyAyCiAzIDAgMgogMTcgNzYgNzcgOTggMTE3CjE3MyA5CiA0IDMgMAogMTA5IDY3IDY4IDkwIDg4IDg5IDkxCjE4NCAzNQogMTIgNyAwCiAxMDcgMTA4IDEwOSA2NSA2NiA2NyA2OCA3NiA3NyA3OCA4MCA4MiAxOSA4NiA4NyA4OCA4OSA5MCA5MQ=="
"OpCodesForDerivatives_light"
"MAo="
"ScopeBlocks_light"
"MTMKMTUgMgogMSAxIDAKIDc2IDEwMAo2NyAyCiAwIDEgMAogMTEyCjc1IDIKIDEgMSAwCiA2NSAxMDAKNzggMgogMSAxIDAKIDc5IDEwMAoxMTMgMTcKIDMgMyAwCiA2OCA4MiA4OSAxOSA4NiA4NwoxMTUgMTEKIDIgMiAwCiA2OCA4OSA4NiA4NwoxMjYgMwogMSAyIDAKIDg5IDE5IDg3CjE0NCAzCiAxIDIgMAogOTAgMTkgODcKMTg1IDIKIDEgMSAwCiA2NSAxMDAKMTg4IDEwCiA5IDQgMAogMTA3IDEwOCAxMDkgNjYgNjcgNjggNzYgNzcgNzggODggODkgOTAgOTEKMjAwIDE4CiA0IDMgMAogODIgODkgOTAgOTEgMTkgODYgODcKMjAyIDEyCiAyIDIgMQogODkgOTAgODYgODcgMTkKMjE0IDMKIDIgMSAxCiA5MCA5MSA4NyAxOQ=="
"source"
"I2xpbmUgMSAibWF5YV9naV9saWdodC5zbCINCg0KDQoNCg0KDQoNCg0KI2xpbmUgMSAiLi4vcnNsL3NoYWRpbmdfdXRpbHMuaCINCg0KDQoNCg0KDQoNCg0KI2xpbmUgMSAiLi4vcnNsL3V0aWxzLmgiDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCiNsaW5lIDIwICIuLi9yc2wvdXRpbHMuaCINCmZsb2F0DQpsdW1pbmFuY2UoIGNvbG9yIGlfY29sb3IgKQ0Kew0KCXJldHVybg0KCQkwLjMgKiBjb21wKGlfY29sb3IsIDApICsgDQoJCTAuNTkgKiBjb21wKGlfY29sb3IsIDEpICsgDQoJCTAuMTEgKiBjb21wKGlfY29sb3IsIDIpOw0KfQ0KDQoNCmZsb2F0IENJRWx1bWluYW5jZShjb2xvciBjKQ0Kew0KCXJldHVybg0KCSAgICAgIGNvbXAoYywgMCkgKiAwLjIxMjY3MQ0KCSAgICArIGNvbXAoYywgMSkgKiAwLjcxNTE2MA0KCSAgICArIGNvbXAoYywgMikgKiAwLjA3MjE2OTsNCn0NCg0KDQpmbG9hdCBzcShmbG9hdCB4KQ0Kew0KCXJldHVybiB4ICogeDsNCn0NCg0KY29sb3INCmNhYnMoIGNvbG9yIGlfY29sb3IgKQ0Kew0KCXJldHVybiBjb2xvcigNCgkJYWJzKGNvbXAoaV9jb2xvciwgMCkpLCBhYnMoY29tcChpX2NvbG9yLDEpKSwgYWJzKGNvbXAoaV9jb2xvciwyKSkgKTsNCn0NCg0KDQpmbG9hdCBmaWx0ZXJlZHB1bHNlIChmbG9hdCBlZGdlMCwgZWRnZTEsIHgsIGR4KQ0Kew0KICAgIGZsb2F0IHgwID0geCAtIGR4LzI7DQogICAgZmxvYXQgeDEgPSB4MCArIGR4Ow0KICAgIHJldHVybiBtYXggKDAsIChtaW4oeDEsZWRnZTEpLW1heCh4MCxlZGdlMCkpIC8gZHgpOw0KfQ0KDQoNCmZsb2F0IGZpbHRlcmVkcHVsc2V0cmFpbiAoZmxvYXQgZWRnZSwgcGVyaW9kLCB4LCBkeCkNCnsNCg0KICAgIGZsb2F0IHcgPSBkeC9wZXJpb2Q7DQogICAgZmxvYXQgeDAgPSB4L3BlcmlvZCAtIHcvMjsNCiAgICBmbG9hdCB4MSA9IHgwK3c7DQogICAgZmxvYXQgbmVkZ2UgPSBlZGdlIC8gcGVyaW9kOw0KDQoNCiAgICBmbG9hdCBpbnRlZ3JhbCAoZmxvYXQgdCkgeyANCiAgICAgICAgZXh0ZXJuIGZsb2F0IG5lZGdlOw0KICAgICAgICByZXR1cm4gKCgxLW5lZGdlKSpmbG9vcih0KSArIG1heCgwLHQtZmxvb3IodCktbmVkZ2UpKTsNCiAgICB9DQoNCglmbG9hdCByZXN1bHQ7DQoJaWYoIHgwID09IHgxICkNCgl7DQoNCgkJcmVzdWx0ID0gKHgwIC0gZmxvb3IoeDApIDwgbmVkZ2UpID8gMCA6IDE7DQoJfQ0KCWVsc2UNCgl7DQogICAgCXJlc3VsdCA9IChpbnRlZ3JhbCh4MSkgLSBpbnRlZ3JhbCh4MCkpIC8gdzsNCg0KDQoNCg0KDQoNCiNsaW5lIDg5ICIuLi9yc2wvdXRpbHMuaCINCgkJZmxvYXQgZXh0aW5jdCA9IHNtb290aHN0ZXAoIDAuNCwgMC41LCB3ICk7DQoJCXJlc3VsdCA9IHJlc3VsdCArIGV4dGluY3QgKiAoMSAtIG5lZGdlIC0gcmVzdWx0KTsNCgl9DQoNCglyZXR1cm4gcmVzdWx0Ow0KfQ0KDQoNCg0KDQojbGluZSA5OSAiLi4vcnNsL3V0aWxzLmgiDQpmbG9hdCBiaWFzKGZsb2F0IGIsIHgpDQp7DQogICAgcmV0dXJuIHBvdyh4LCBsb2coYikvLTAuNjkzMTQ3MTgwNTU5OTQ1KTsNCn0NCg0Kdm9pZA0KY29sb3JCYWxhbmNlKA0KCW91dHB1dCBjb2xvciBpb19vdXRDb2xvcjsNCglvdXRwdXQgZmxvYXQgaW9fb3V0QWxwaGE7DQoJdW5pZm9ybSBmbG9hdCBpX2FscGhhSXNMdW1pbmFuY2U7DQoJZmxvYXQgaV9hbHBoYUdhaW47DQoJZmxvYXQgaV9hbHBoYU9mZnNldDsNCgljb2xvciBpX2NvbG9yR2FpbjsNCgljb2xvciBpX2NvbG9yT2Zmc2V0Ow0KCXVuaWZvcm0gZmxvYXQgaV9pbnZlcnQ7ICkNCnsNCglpZihpX2ludmVydCAhPSAwLjApDQoJew0KCQlpb19vdXRDb2xvciA9IDEgLSBpb19vdXRDb2xvcjsNCgkJaW9fb3V0QWxwaGEgPSAxIC0gaW9fb3V0QWxwaGE7DQoJfQ0KDQoJaWYoaV9hbHBoYUlzTHVtaW5hbmNlICE9IDAuMCkNCgl7DQoJCWlvX291dEFscGhhID0gbHVtaW5hbmNlKCBpb19vdXRDb2xvciApOw0KCX0NCg0KCWlvX291dENvbG9yICo9IGlfY29sb3JHYWluOw0KCWlvX291dENvbG9yICs9IGlfY29sb3JPZmZzZXQ7DQoNCglpb19vdXRBbHBoYSAqPSBpX2FscGhhR2FpbjsNCglpb19vdXRBbHBoYSArPSBpX2FscGhhT2Zmc2V0Ow0KfQkNCg0KDQoNCiNsaW5lIDEwICIuLi9yc2wvc2hhZGluZ191dGlscy5oIg0KI2xpbmUgMSAiLi4vcnNsL2dsb2JhbF9pbGx1bWluYXRpb24uaCINCg0KDQoNCg0KDQoNCg0KDQojbGluZSAxNCAiLi4vcnNsL2dsb2JhbF9pbGx1bWluYXRpb24uaCINCmZsb2F0DQpnZXRHaUVmZmVjdCgpDQp7DQoJdW5pZm9ybSBmbG9hdCBlZmZlY3QgPSAwOw0KCW9wdGlvbiggInVzZXI6XzNkZm1fZ2lfZWZmZWN0IiwgZWZmZWN0ICk7DQoNCglyZXR1cm4gZWZmZWN0Ow0KfQ0KDQpmbG9hdCBnZXRHaUFkZFRvRmluYWxNaXgoKQ0Kew0KCXVuaWZvcm0gZmxvYXQgYWRkX3RvX2ZpbmFsX21peCA9IDA7DQoJb3B0aW9uKCAidXNlcjpfM2RmbV9naV9hZGRfdG9fZmluYWxfbWl4IiwgYWRkX3RvX2ZpbmFsX21peCApOw0KDQoJcmV0dXJuIGFkZF90b19maW5hbF9taXg7DQp9DQoNCg0KDQoNCg0KY29sb3INCmdldEdsb2JhbElsbHVtaW5hdGlvbkNvbXBvbmVudHMoDQoJdmFyeWluZyBub3JtYWwgaV9OOw0KCXZhcnlpbmcgY29sb3IgaV9naV93ZWlnaHQ7DQoJb3V0cHV0IHZhcnlpbmcgY29sb3Igb192aXNpYmlsaXR5Ow0KCW91dHB1dCB2YXJ5aW5nIGNvbG9yIG9fZW52X2RpZmZ1c2U7DQoJb3V0cHV0IHZhcnlpbmcgY29sb3Igb19jb2xvcl9ibGVlZGluZzspDQp7DQoJZXh0ZXJuIHBvaW50IFA7DQoJc2hhZGVyIGdpX3NoYWRlciA9IGdldHNoYWRlciggIm1heWFfZ2lfc2hhZGVyIiApOw0KCWlmKCBnaV9zaGFkZXIgIT0gbnVsbCApDQoJew0KCQl1bmlmb3JtIGZsb2F0IGVmZmVjdCA9IDA7DQoJCWdldHZhciggZ2lfc2hhZGVyLCAiZWZmZWN0IiwgZWZmZWN0ICk7DQoJCWlmKCBlZmZlY3QgIT0gMCApDQoJCXsNCgkJCXZhcnlpbmcgY29sb3IgZ2kgPSBnaV9zaGFkZXItPkNvbXB1dGVHSSggUCwgaV9OLCBpX2dpX3dlaWdodCApOw0KCQkJZ2V0dmFyKCBnaV9zaGFkZXIsICJvdXRfdmlzaWJpbGl0eSIsIG9fdmlzaWJpbGl0eSApOw0KCQkJZ2V0dmFyKCBnaV9zaGFkZXIsICJvdXRfZW52aXJvbm1lbnRfZGlmZnVzZSIsIG9fZW52X2RpZmZ1c2UgKTsNCgkJCWdldHZhciggZ2lfc2hhZGVyLCAib3V0X2NvbG9yX2JsZWVkaW5nIiwgb19jb2xvcl9ibGVlZGluZyApOw0KCQkJcmV0dXJuIGdpOw0KCQl9DQoJfQ0KDQoJb192aXNpYmlsaXR5ID0gMTsNCglvX2Vudl9kaWZmdXNlID0gMDsNCglvX2NvbG9yX2JsZWVkaW5nID0gMDsNCglyZXR1cm4gY29sb3IoMCk7DQp9DQoNCmNvbG9yDQpjb21wdXRlSW5kaXJlY3REaWZmdXNlQW5kR0lBT1ZzKA0KCWNvbG9yIGlfZGlmZnVzZV9mYWN0b3I7DQoJY29sb3IgaV9zdXJmYWNlX2NvbG9yOw0KCWNvbG9yIGlfc3VyZmFjZV90cmFuc3BhcmVuY3k7DQoJbm9ybWFsIGlfTiApDQp7DQoJY29sb3IgZ2lfd2VpZ2h0ID0gaV9zdXJmYWNlX2NvbG9yICogaV9kaWZmdXNlX2ZhY3RvcjsNCg0KCWNvbG9yIHZpc2liaWxpdHk7DQoJY29sb3IgZW52X2RpZmZ1c2U7DQoJY29sb3IgY29sb3JfYmxlZWRpbmc7DQoNCgljb2xvciBnaSA9IGdldEdsb2JhbElsbHVtaW5hdGlvbkNvbXBvbmVudHMoDQoJCWlfTiwgZ2lfd2VpZ2h0LA0KCQl2aXNpYmlsaXR5LCBlbnZfZGlmZnVzZSwgY29sb3JfYmxlZWRpbmcgKTsNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KCXJldHVybiBpX2RpZmZ1c2VfZmFjdG9yICogZ2k7DQp9DQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCiNsaW5lIDI2NyAiLi4vcnNsL2dsb2JhbF9pbGx1bWluYXRpb24uaCINCmZsb2F0DQpnZXRHaUVudmlyb25tZW50TWFwUGFyYW1ldGVycygNCglvdXRwdXQgdW5pZm9ybSBzdHJpbmcgZW52bWFwOw0KCW91dHB1dCB1bmlmb3JtIHN0cmluZyBlbnZzcGFjZTspDQp7DQoJZW52bWFwID0gIiI7DQoJZW52c3BhY2UgPSAiIjsNCg0KCXVuaWZvcm0gZmxvYXQgZW52bWFwX2ZvdW5kID0gDQoJCW9wdGlvbiggInVzZXI6XzNkZm1fZ2lfZW52aXJvbm1lbnRfbWFwIiwgZW52bWFwICk7DQoJb3B0aW9uKCAidXNlcjpfM2RmbV9naV9lbnZpcm9ubWVudF9zcGFjZSIsIGVudnNwYWNlICk7DQoNCglyZXR1cm4gZW52bWFwX2ZvdW5kOw0KfQ0KDQpmbG9hdA0KZ2V0R2lFbnZpcm9ubWVudFBhcmFtZXRlcnMoDQoJb3V0cHV0IHVuaWZvcm0gc3RyaW5nIGVudm1hcDsNCglvdXRwdXQgdW5pZm9ybSBzdHJpbmcgZW52c3BhY2U7DQoJb3V0cHV0IHVuaWZvcm0gZmxvYXQgZW52X2ludGVuc2l0eTsNCglvdXRwdXQgdW5pZm9ybSBjb2xvciBlbnZfY29sb3JfZ2FpbjsNCglvdXRwdXQgdW5pZm9ybSBjb2xvciBlbnZfY29sb3Jfb2Zmc2V0Ow0KCW91dHB1dCB1bmlmb3JtIGZsb2F0IGVudl9zcGVjdWxhcml0eTsgKQ0Kew0KCWVudm1hcCA9ICIiOw0KCWVudnNwYWNlID0gIiI7DQoJZW52X2ludGVuc2l0eSA9IDEuMDsNCgllbnZfY29sb3JfZ2FpbiA9IDEuMDsNCgllbnZfY29sb3Jfb2Zmc2V0ID0gMC4wOw0KCWVudl9zcGVjdWxhcml0eSA9IDA7DQoNCgl1bmlmb3JtIGZsb2F0IGVudm1hcF9mb3VuZCA9IGdldEdpRW52aXJvbm1lbnRNYXBQYXJhbWV0ZXJzKCBlbnZtYXAsIGVudnNwYWNlICk7DQoNCglpZiggZW52bWFwX2ZvdW5kICkNCgl7DQoJCW9wdGlvbiggInVzZXI6XzNkZm1fZ2lfZW52aXJvbm1lbnRfaW50ZW5zaXR5IiwgZW52X2ludGVuc2l0eSApOw0KCQlvcHRpb24oICJ1c2VyOl8zZGZtX2dpX2Vudmlyb25tZW50X2NvbG9yX2dhaW4iLCBlbnZfY29sb3JfZ2FpbiApOw0KCQlvcHRpb24oICJ1c2VyOl8zZGZtX2dpX2Vudmlyb25tZW50X2NvbG9yX29mZnNldCIsIGVudl9jb2xvcl9vZmZzZXQgKTsNCgkJb3B0aW9uKCAidXNlcjpfM2RmbV9naV9lbnZpcm9ubWVudF9zcGVjdWxhcml0eSIsIGVudl9zcGVjdWxhcml0eSApOw0KCX0NCg0KCXJldHVybiBlbnZtYXBfZm91bmQ7DQp9DQoNCg0KDQoNCmNvbG9yIGdldEdpRW52aXJvbm1lbnRTcGVjdWxhcigNCgl2ZWN0b3IgaV9kaXI7DQoJZmxvYXQgaV9zYW1wbGVzOw0KCWZsb2F0IGlfYmx1cikNCnsNCgljb2xvciBlbnZfY29sb3IgPSAwOw0KDQoJdW5pZm9ybSBzdHJpbmcgZW52bWFwID0gIiI7DQoJdW5pZm9ybSBzdHJpbmcgZW52c3BhY2UgPSAiIjsNCgl1bmlmb3JtIGZsb2F0IGVudl9pbnRlbnNpdHkgPSAxLjA7DQoJdW5pZm9ybSBjb2xvciBlbnZfY29sb3JfZ2FpbiA9IDEuMDsNCgl1bmlmb3JtIGNvbG9yIGVudl9jb2xvcl9vZmZzZXQgPSAwLjA7DQoJdW5pZm9ybSBmbG9hdCBlbnZfc3BlY3VsYXJpdHkgPSAwOw0KCXVuaWZvcm0gZmxvYXQgZW52bWFwX2ZvdW5kID0gZ2V0R2lFbnZpcm9ubWVudFBhcmFtZXRlcnMoIGVudm1hcCwgZW52c3BhY2UsIA0KCQllbnZfaW50ZW5zaXR5LCBlbnZfY29sb3JfZ2FpbiwgZW52X2NvbG9yX29mZnNldCwgZW52X3NwZWN1bGFyaXR5ICk7DQoNCglpZiggZW52bWFwX2ZvdW5kICE9IDAgJiYgZW52X3NwZWN1bGFyaXR5ID4gMCApDQoJew0KCQl2ZWN0b3IgZGlyID0gaV9kaXI7DQoNCgkJaWYoIGVudnNwYWNlICE9ICIiICkNCgkJCWRpciA9IHRyYW5zZm9ybSggZW52c3BhY2UsIGlfZGlyICk7DQoNCgkJZW52X2NvbG9yID0gZW52aXJvbm1lbnQoDQoJCQllbnZtYXAsIGRpciwgZGlyLCBkaXIsIGRpciwgDQoJCQkic2FtcGxlcyIsIGlfc2FtcGxlcywgImJsdXIiLCBpX2JsdXIpOw0KDQoJCWVudl9jb2xvciA9IGVudl9jb2xvciAqIGVudl9jb2xvcl9nYWluICsgZW52X2NvbG9yX29mZnNldDsNCgkJZW52X2NvbG9yICo9IGVudl9pbnRlbnNpdHkgKiBlbnZfc3BlY3VsYXJpdHk7DQoJfQ0KDQoJcmV0dXJuIGVudl9jb2xvcjsNCn0NCg0KDQoNCiNsaW5lIDExICIuLi9yc2wvc2hhZGluZ191dGlscy5oIg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQojbGluZSAyOCAiLi4vcnNsL3NoYWRpbmdfdXRpbHMuaCINCm5vcm1hbCBTaGFkaW5nTm9ybWFsKCBub3JtYWwgaV9OICkNCnsNCglleHRlcm4gdmVjdG9yIEk7DQoJbm9ybWFsIE5mID0gaV9OOw0KDQoJdW5pZm9ybSBmbG9hdCBzaWRlcyA9IDI7DQoJYXR0cmlidXRlKCJTaWRlcyIsIHNpZGVzKTsNCg0KCWlmKCBzaWRlcyA9PSAyICkNCgl7DQoJCU5mID0gZmFjZWZvcndhcmQoTmYsIEkpOw0KCX0NCgllbHNlDQoJew0KDQoNCiNsaW5lIDQ0ICIuLi9yc2wvc2hhZGluZ191dGlscy5oIg0KCQl1bmlmb3JtIGZsb2F0IGdlb21ldHJpY25vcm1hbCA9IDE7DQoJCWF0dHJpYnV0ZSggImdlb21ldHJ5Omdlb21ldHJpY25vcm1hbCIsIGdlb21ldHJpY25vcm1hbCApOw0KDQoJCWlmKCBnZW9tZXRyaWNub3JtYWwgPT0gMCApDQoJCXsNCgkJCXVuaWZvcm0gc3RyaW5nIG9yaWVudGF0aW9uOw0KCQkJYXR0cmlidXRlKCAiUmk6T3JpZW50YXRpb24iLCBvcmllbnRhdGlvbiApOw0KCQkJaWYoIG9yaWVudGF0aW9uID09ICJvdXRzaWRlIiApDQoJCQkJTmYgPSAtTmY7DQoJCX0NCgl9DQoNCglyZXR1cm4gTmY7DQp9DQoNCg0KDQoNCiNsaW5lIDYyICIuLi9yc2wvc2hhZGluZ191dGlscy5oIg0KY29sb3IgZ2V0QW1iaWVudCggbm9ybWFsIGlfTjsgKQ0Kew0KCXJldHVybiBhbWJpZW50KCk7DQp9DQoNCmNvbG9yIGdldEFtYmllbnRVbnNoYWRvd2VkKCBub3JtYWwgaV9OICkNCnsNCglleHRlcm4gcG9pbnQgUDsNCgljb2xvciBhbWIgPSAwOw0KDQoJaWxsdW1pbmFuY2UoIFAgKQ0KCXsNCgkJaWYoIEwgPT0gMCApDQoJCXsNCgkJCWNvbG9yIHVuc2hhZG93ZWRfY2wgPSAwOw0KCQkJbGlnaHRzb3VyY2UoIl9fM2RmbV91bnNoYWRvd2VkX2NsIiwgdW5zaGFkb3dlZF9jbCk7DQoJCQlhbWIgKz0gdW5zaGFkb3dlZF9jbDsNCgkJfQ0KCX0NCg0KCXJldHVybiBhbWI7DQp9DQoNCg0KDQoNCiNsaW5lIDg4ICIuLi9yc2wvc2hhZGluZ191dGlscy5oIg0KY29sb3IgZ2V0RGlmZnVzZSgNCglub3JtYWwgaV9OOw0KCXVuaWZvcm0gZmxvYXQga2V5TGlnaHRzT25seTsNCgl1bmlmb3JtIGZsb2F0IHVuc2hhZG93ZWQ7ICkNCnsNCglleHRlcm4gcG9pbnQgUDsNCgljb2xvciBDID0gMDsNCg0KCWlsbHVtaW5hbmNlKCBQLCBpX04sIFBJLzIgKQ0KCXsNCgkJZmxvYXQgaXNLZXlMaWdodCA9IDE7DQoNCgkJaWYoIGtleUxpZ2h0c09ubHkgIT0gMCApDQoJCXsNCgkJCWlzS2V5TGlnaHQgPSAwOw0KCQkJbGlnaHRzb3VyY2UoICJpc2tleWxpZ2h0IiwgaXNLZXlMaWdodCApOw0KCQl9DQoNCgkJaWYoIGlzS2V5TGlnaHQgIT0gMCApDQoJCXsNCgkJCWZsb2F0IG5vbmRpZmZ1c2UgPSAwOw0KCQkJbGlnaHRzb3VyY2UoICJfX25vbmRpZmZ1c2UiLCBub25kaWZmdXNlICk7DQoNCgkJCWlmKCBub25kaWZmdXNlIDwgMSApDQoJCQl7DQoJCQkJdmFyeWluZyBjb2xvciBjdXJfY2w7DQoJCQkJeyBjdXJfY2wgPSBDbDsgaWYoIHVuc2hhZG93ZWQgIT0gMCApIGxpZ2h0c291cmNlKCJfXzNkZm1fdW5zaGFkb3dlZF9jbCIsIGN1cl9jbCk7IH07DQoJCQkJQyArPSBjdXJfY2wgKiBub3JtYWxpemUoTCkuaV9OICogKDEtbm9uZGlmZnVzZSk7DQoJCQl9DQoJCX0NCgl9DQoNCglyZXR1cm4gQzsNCn0NCg0KY29sb3IgZ2V0VHJhbnNsdWNlbmNlKA0KCW5vcm1hbCBpX047DQoJZmxvYXQgaV90cmFuc2x1Y2VuY2UsIGlfdHJhbnNsdWNlbmNlRGVwdGgsIGlfdHJhbnNsdWNlbmNlRm9jdXM7KQ0Kew0KCWV4dGVybiBwb2ludCBQOw0KCWV4dGVybiB2ZWN0b3IgSTsNCg0KDQoNCg0KDQojbGluZSAxMzQgIi4uL3JzbC9zaGFkaW5nX3V0aWxzLmgiDQogCWZsb2F0IGZvY3VzID0gbWluKCBpX3RyYW5zbHVjZW5jZUZvY3VzLCAwLjk5OTk5ICk7DQoNCgljb2xvciBDID0gMDsNCg0KCWlmKCBpX3RyYW5zbHVjZW5jZSA+IDAuMCApDQoJew0KCQlpbGx1bWluYW5jZSggUCApDQoJCXsNCgkJCWZsb2F0IG5vbmRpZmZ1c2UgPSAwOw0KCQkJbGlnaHRzb3VyY2UoICJfX25vbmRpZmZ1c2UiLCBub25kaWZmdXNlICk7DQoNCgkJCWlmKCBub25kaWZmdXNlIDwgMSApDQoJCQl7DQoJCQkJZmxvYXQgY29zdGhldGEgPSBub3JtYWxpemUoTCkubm9ybWFsaXplKEkpOw0KIAkJCQlmbG9hdCBhID0gKDEgKyBjb3N0aGV0YSkgKiAwLjU7DQoNCiAJCQkJZmxvYXQgdHJzID0gcG93KCBwb3coYSwgZm9jdXMpLCAxLygxLWZvY3VzKSApOw0KDQogIAkJCQlDICs9IENsICogdHJzICogKDEtbm9uZGlmZnVzZSk7DQoJCQl9DQoJCX0NCgl9DQoNCglyZXR1cm4gQyAqIGlfdHJhbnNsdWNlbmNlOw0KfQ0KDQpjb2xvcg0KZ2V0Qmxpbm4oIA0KCQlub3JtYWwgaV9OZjsNCgkJZmxvYXQgaV9lY2NlbnRyaWNpdHk7DQoJCWZsb2F0IGlfc3BlY3VsYXJSb2xsT2ZmOw0KCQl1bmlmb3JtIGZsb2F0IGlfa2V5TGlnaHRzT25seTsNCgkJdW5pZm9ybSBmbG9hdCB1bnNoYWRvd2VkOw0KCQkpDQp7DQoJZmxvYXQgRTsNCgljb2xvciBDID0gMDsNCgl2ZWN0b3IgSCwgTG4sIFYsIE5uOw0KCWZsb2F0IE5ILCBOSDIsIE5IU1FSLCBEZCwgR2csIFZOLCBWSCwgTE4sIEZmLCB0bXA7DQoJZXh0ZXJuIHBvaW50IFA7DQoJZXh0ZXJuIHZlY3RvciBMLCBJOw0KCWV4dGVybiBjb2xvciBDbDsNCg0KCWlmKGlfZWNjZW50cmljaXR5ICE9IDEpDQoJCUUgPSAxIC8gKCggKGlfZWNjZW50cmljaXR5KSAqIChpX2VjY2VudHJpY2l0eSkgKSAtIDEpOw0KCWVsc2UNCgkJRSA9IC0xZTU7DQoNCglWID0gbm9ybWFsaXplKC1JKTsNCglWTiA9IFYgLiBpX05mOw0KDQoJaWxsdW1pbmFuY2UoIFAsIGlfTmYsIFBJIC8gMikNCgl7DQoJCWZsb2F0IGlzS2V5TGlnaHQgPSAxOw0KDQoJCWlmKCBpX2tleUxpZ2h0c09ubHkgIT0gMCApDQoJCXsNCgkJCWxpZ2h0c291cmNlKCAiaXNrZXlsaWdodCIsIGlzS2V5TGlnaHQgKTsNCgkJfQ0KDQoJCWlmKCBpc0tleUxpZ2h0ICE9IDAgKQ0KCQl7DQoJCQlmbG9hdCBub25zcGVjdWxhciA9IDA7DQoJCQlsaWdodHNvdXJjZSggIl9fbm9uc3BlY3VsYXIiLCBub25zcGVjdWxhciApOw0KDQoJCQlpZiggbm9uc3BlY3VsYXIgPCAxICkNCgkJCXsNCgkJCQlMbiA9IG5vcm1hbGl6ZShMKTsNCgkJCQlIID0gbm9ybWFsaXplKExuICsgVik7DQoJCQkJTkggPSBpX05mIC4gSDsNCgkJCQlOSFNRUiA9ICggKE5IKSAqIChOSCkgKTsNCgkJCQlOSDIgPSBOSCAqIDI7DQoJCQkJRGQgPSAoRSArIDEpIC8gKE5IU1FSICsgRSk7DQoJCQkJRGQgKj0gRGQ7DQoJCQkJVkggPSBWIC4gSDsNCgkJCQlMTiA9IExuIC4gaV9OZjsNCgkJCQlpZihWTiA8IExOKQ0KCQkJCXsNCgkJCQkJaWYoVk4gKiBOSDIgPCBWSCkNCgkJCQkJCUdnID0gTkgyIC8gVkg7DQoJCQkJCWVsc2UNCgkJCQkJCUdnID0gMSAvIFZOOw0KCQkJCX0NCgkJCQllbHNlDQoJCQkJew0KCQkJCQlpZihMTiAqIE5IMiA8IFZIKQ0KCQkJCQkJR2cgPSAoTE4gKiBOSDIpIC8gKFZIICogVk4pOw0KCQkJCQllbHNlDQoJCQkJCQlHZyA9IDEgLyBWTjsNCgkJCQl9DQoNCgkJCQl0bXAgPSBwb3coKDEgLSBWSCksIDMpOw0KCQkJCUZmID0gdG1wICsgKDEgLSB0bXApICogaV9zcGVjdWxhclJvbGxPZmY7DQoNCgkJCQl2YXJ5aW5nIGNvbG9yIGN1cl9jbDsNCgkJCQl7IGN1cl9jbCA9IENsOyBpZiggdW5zaGFkb3dlZCAhPSAwICkgbGlnaHRzb3VyY2UoIl9fM2RmbV91bnNoYWRvd2VkX2NsIiwgY3VyX2NsKTsgfTsNCgkJCQlDICs9IGN1cl9jbCAqIERkICogR2cgKiBGZiAqICgxLW5vbnNwZWN1bGFyKTsNCgkJCX0NCgkJfQ0KCX0NCglyZXR1cm4gQzsNCn0NCg0KY29sb3IgZ2V0QW5pc290cm9waWMoDQoJCXZlY3RvciBpX04sIGlfSSwgaV94ZGlyOw0KCQlmbG9hdCBpX2ZyZXNuZWwsIGlfcm91Z2huZXNzLCBpX3NwcmVhZHgsIGlfc3ByZWFkeTsNCgkJdW5pZm9ybSBmbG9hdCBpX2tleUxpZ2h0c09ubHksIHVuc2hhZG93ZWQ7KQ0Kew0KDQoJZmxvYXQgc3RhbV9hbmlzb3Ryb3B5KCBmbG9hdCB1LCB2LCB3LCByeCwgcnkgKQ0KCXsNCgkJZmxvYXQgdzIgPSB3ICogdzsNCgkJZmxvYXQgYnQgPSA0ICogUEkgKiB3MiAqIHcyICogcnggKiByeTsNCgkJZmxvYXQgZXggPSBleHAoLSB1ICogdSAvICg0ICogdzIgKiByeCAqIHJ4KSkgKiBleHAoIC0gdiAqIHYgLyAoNCAqIHcyICogcnkgKiByeSkpOw0KDQoJCXJldHVybiBleCAvIGJ0Ow0KCX0NCg0KCWV4dGVybiBwb2ludCBQOw0KCXZlY3RvciB5ZGlyICA9IGlfTiBeIGlfeGRpcjsNCg0KCWZsb2F0IGNvc3RoZXRhMiA9IGlfSS5pX047DQoNCg0KDQoJZmxvYXQgcnggPSBpX3JvdWdobmVzcyAvIGlfc3ByZWFkeDsNCglmbG9hdCByeSA9IGlfcm91Z2huZXNzIC8gaV9zcHJlYWR5Ow0KDQoJZmxvYXQgZXhpc3RzLCBlbWl0c3BlYyA9IDA7DQoJY29sb3IgQ2xub1NoYWRvdyA9IDA7DQoJY29sb3Igc3BlYyA9IDA7DQoNCglpbGx1bWluYW5jZSggUCwgaV9OLCBQSSAvIDIgKQ0KCXsNCgkJZmxvYXQgaXNLZXlMaWdodCA9IDE7DQoNCgkJaWYoIGlfa2V5TGlnaHRzT25seSAhPSAwICkNCgkJew0KCQkJbGlnaHRzb3VyY2UoICJpc2tleWxpZ2h0IiwgaXNLZXlMaWdodCApOw0KCQl9DQoNCgkJaWYoIGlzS2V5TGlnaHQgIT0gMCApDQoJCXsNCgkJCWZsb2F0IG5vbnNwZWN1bGFyID0gMDsNCgkJCWxpZ2h0c291cmNlKCAiX19ub25zcGVjdWxhciIsIG5vbnNwZWN1bGFyICk7DQoNCgkJCWlmKCBub25zcGVjdWxhcjwxICYmIGlfTi5MPjAgKQ0KCQkJew0KCQkJCXZlY3RvciBMbiA9IG5vcm1hbGl6ZShMKTsNCg0KCQkJCWZsb2F0IGNvc3RoZXRhMSA9IExuLmlfTjsNCgkJCQl2ZWN0b3IgViA9IExuICsgaV9JOw0KDQoJCQkJZmxvYXQgdiA9IFYuaV94ZGlyOw0KCQkJCWZsb2F0IHUgPSBWLnlkaXI7DQoJCQkJZmxvYXQgdyA9IFYuaV9OOw0KDQoJCQkJZmxvYXQgRyA9ICgxICsgTG4uaV9JKTsNCgkJCQlHID0gY2xhbXAoIEcgKiBHIC8gKGNvc3RoZXRhMSpjb3N0aGV0YTIpLCAwLCAxKTsNCg0KCQkJCWZsb2F0IEQgPSBzdGFtX2FuaXNvdHJvcHkoIHUsIHYsIHcsIHJ4LCByeSApOw0KDQoJCQkJZmxvYXQgZmFjdG9yID0gIEcgKiBEOw0KCQkJCWZsb2F0IEhkb3RJID0gVi5pX0kgLyBsZW5ndGgoVik7DQoJCQkJSGRvdEkgPSAxLjAgLSBIZG90STsNCgkJCQlIZG90SSA9IEhkb3RJICogSGRvdEkgKiBIZG90STsNCgkJCQlmYWN0b3IgKj0gSGRvdEkgKyAoMS4wIC0gSGRvdEkpOw0KCQkJCWZhY3RvciA9IGNsYW1wKGZhY3RvciwgMCwgMSkgKiBpX2ZyZXNuZWw7DQoNCgkJCQl2YXJ5aW5nIGNvbG9yIGN1cl9jbDsNCgkJCQl7IGN1cl9jbCA9IENsOyBpZiggdW5zaGFkb3dlZCAhPSAwICkgbGlnaHRzb3VyY2UoIl9fM2RmbV91bnNoYWRvd2VkX2NsIiwgY3VyX2NsKTsgfTsNCgkJCQlzcGVjICs9IGZhY3RvciAqIGN1cl9jbCAqICgxLW5vbnNwZWN1bGFyKTsNCgkJCX0NCgkJfQ0KCX0NCglyZXR1cm4gIHNwZWMvNDsgICAgDQp9DQoNCnZvaWQNCmNvbXB1dGVTdXJmYWNlVHJhbnNwYXJlbmN5KA0KCWZsb2F0IGlfbWF0dGVPcGFjaXR5TW9kZTsNCglmbG9hdCBpX21hdHRlT3BhY2l0eTsNCgljb2xvciBpX3RyYW5zcGFyZW5jeTsNCglvdXRwdXQgY29sb3Igb19vdXRUcmFuc3BhcmVuY3kgKQ0Kew0KCWlmKGlfbWF0dGVPcGFjaXR5TW9kZSA9PSAwKQ0KCXsNCg0KCQlvX291dFRyYW5zcGFyZW5jeSA9IDA7DQoJfQ0KCWVsc2UgaWYoaV9tYXR0ZU9wYWNpdHlNb2RlID09IDEpDQoJew0KDQoJCW9fb3V0VHJhbnNwYXJlbmN5ID0gaV9tYXR0ZU9wYWNpdHk7DQoJfQ0KCWVsc2UNCgl7DQoNCgkJb19vdXRUcmFuc3BhcmVuY3kgPSAoMSAtIGlfdHJhbnNwYXJlbmN5KSAqIGlfbWF0dGVPcGFjaXR5Ow0KCX0NCg0KCW9fb3V0VHJhbnNwYXJlbmN5ID0gMS4wIC0gb19vdXRUcmFuc3BhcmVuY3k7DQp9DQoNCnZvaWQgY29tcHV0ZVN1cmZhY2UoDQoJY29sb3IgaV9zdXJmYWNlQ29sb3I7DQoJY29sb3IgaV90cmFuc3BhcmVuY3k7DQoJZmxvYXQgaV9tYXR0ZU9wYWNpdHlNb2RlOw0KCWZsb2F0IGlfbWF0dGVPcGFjaXR5Ow0KCW91dHB1dCBjb2xvciBvX291dENvbG9yOw0KCW91dHB1dCBjb2xvciBvX291dFRyYW5zcGFyZW5jeTsNCgkpDQp7DQoJY29tcHV0ZVN1cmZhY2VUcmFuc3BhcmVuY3koDQoJCWlfbWF0dGVPcGFjaXR5TW9kZSwgaV9tYXR0ZU9wYWNpdHksIGlfdHJhbnNwYXJlbmN5LCBvX291dFRyYW5zcGFyZW5jeSApOw0KDQoJb19vdXRDb2xvciA9IGlfc3VyZmFjZUNvbG9yICogKDEgLSBvX291dFRyYW5zcGFyZW5jeSk7DQoJb19vdXRDb2xvciA9IGNsYW1wKG9fb3V0Q29sb3IsIDAsIDFlMzApOw0KfQ0KDQpmbG9hdCByYXlTcGVjdWxhckRlcHRoKCkNCnsNCgl1bmlmb3JtIGZsb2F0IGRlcHRoID0gMDsNCglyYXlpbmZvKCAic3BlY3VsYXJkZXB0aCIsIGRlcHRoICk7DQoJcmV0dXJuIGRlcHRoOw0KfQ0KDQpjb2xvciBnZXRSZWZsZWN0aW9uKA0KCW5vcm1hbCBpX047DQoJdmVjdG9yIGlfSTsNCgljb2xvciBpX3NwZWN1bGFyQ29sb3I7DQoJZmxvYXQgaV9yZWZsZWN0aXZpdHk7DQoJY29sb3IgaV9yZWZsZWN0ZWRDb2xvcjsNCgl1bmlmb3JtIGZsb2F0IGlfbWF4RGlzdGFuY2U7DQoJdW5pZm9ybSBmbG9hdCBpX3NhbXBsZXM7DQoJdW5pZm9ybSBmbG9hdCBpX2JsdXI7DQoJdW5pZm9ybSBmbG9hdCBpX25vaXNlQW1wOw0KCXVuaWZvcm0gZmxvYXQgaV9ub2lzZUZyZXE7DQoJdW5pZm9ybSBmbG9hdCBpX3JlZmxlY3Rpb25MaW1pdCApDQp7DQoJZXh0ZXJuIHBvaW50IFA7DQoJZXh0ZXJuIHVuaWZvcm0gZmxvYXQgX19yZWZsZWN0czsNCg0KDQoNCg0KDQojbGluZSAzODUgIi4uL3JzbC9zaGFkaW5nX3V0aWxzLmgiDQoJY29sb3IgcmF5X2NvbG9yYXRpb24gPSBpX3NwZWN1bGFyQ29sb3IgKiBpX3JlZmxlY3Rpdml0eTsNCg0KDQoJY29sb3IgZW52X2NvbG9yID0gaV9yZWZsZWN0ZWRDb2xvcjsNCg0KCWNvbG9yIHJlZmxlY3RlZCA9IGVudl9jb2xvcjsNCg0KCWlmKCByYXlfY29sb3JhdGlvbiAhPSBjb2xvcigwKSAmJg0KCSAgICByYXlTcGVjdWxhckRlcHRoKCkgPCBpX3JlZmxlY3Rpb25MaW1pdCAmJg0KCSAgICBfX3JlZmxlY3RzICE9IDApDQoJew0KCQl2ZWN0b3IgUiA9IHJlZmxlY3QoIGlfSSwgaV9OICk7DQoNCgkJaWYoIGlfbm9pc2VBbXAgIT0gMCAmJiBpX25vaXNlRnJlcSAhPSAwKQ0KCQl7DQoJCQlwb2ludCBQb2JqID0gdHJhbnNmb3JtKCJvYmplY3QiLCBQKTsNCgkJCVIgPSBtaXgoIFIsIFIgKiBub2lzZSggUG9iaiAqIGlfbm9pc2VGcmVxICksIGlfbm9pc2VBbXAgKTsNCgkJfQ0KDQoJCWNvbG9yIHRyczsNCgkJY29sb3IgcmMgPSB0cmFjZSgNCgkJCQlQLCBSLA0KCQkJCSJzdWJzZXQiLCAiLV8zZGZtX25vdF92aXNpYmxlX2luX3JlZmxlY3Rpb25zIiwNCgkJCQkibWF4ZGlzdCIsIGlfbWF4RGlzdGFuY2UsDQoJCQkJInNhbXBsZWNvbmUiLCBpX2JsdXIsDQoJCQkJInNhbXBsZXMiLCBpX3NhbXBsZXMsDQoJCQkJInRyYW5zbWlzc2lvbiIsIHRycywNCgkJCQkid2VpZ2h0IiwgcmF5X2NvbG9yYXRpb24gKTsNCg0KDQoNCg0KDQoNCg0KDQoNCg0KCQlpZiggdHJzICE9IDAgKQ0KCQl7DQoJCQl2YXJ5aW5nIGNvbG9yIGdpX2Vudl9jb2xvciA9IGdldEdpRW52aXJvbm1lbnRTcGVjdWxhcihSLCBpX3NhbXBsZXMsIGlfYmx1cik7DQoNCg0KDQoNCg0KDQoNCg0KDQoJCQl1bmlmb3JtIGZsb2F0IGFkZF90b19maW5hbF9taXggPSBnZXRHaUFkZFRvRmluYWxNaXgoKTsNCgkJCWlmKCBhZGRfdG9fZmluYWxfbWl4ID4gMCApDQoJCQl7DQoJCQkJcmVmbGVjdGVkICs9IGdpX2Vudl9jb2xvcjsNCgkJCX0NCg0KDQoNCg0KCQl9DQoNCg0KDQoNCgkJcmVmbGVjdGVkICo9IHRyczsNCgkJcmVmbGVjdGVkICs9IHJjOw0KCX0NCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoJcmV0dXJuIHJlZmxlY3RlZCAqIHJheV9jb2xvcmF0aW9uOw0KfQ0KDQpmbG9hdCBkb1JlZnJhY3Rpb24oDQoJbm9ybWFsIGlfTjsNCgl2ZWN0b3IgaV9JOw0KCXVuaWZvcm0gZmxvYXQgaV9yZWZyYWN0aW9uczsNCglmbG9hdCBpX3JlZnJhY3RpdmVJbmRleDsNCgl1bmlmb3JtIGZsb2F0IGlfcmVmcmFjdGlvbkxpbWl0Ow0KCWZsb2F0IGlfbGlnaHRBYnNvcmJhbmNlOw0KCWZsb2F0IGlfc2hhZG93QXR0ZW51YXRpb247DQoJb3V0cHV0IGNvbG9yIGlvX3RyYW5zcGFyZW5jeTsNCglvdXRwdXQgY29sb3Igb19yZWZyYWN0aW9uOyApDQp7DQoNCg0KDQoJZXh0ZXJuIHBvaW50IFA7DQoJdW5pZm9ybSBzdHJpbmcgcmF5VHlwZTsNCgl1bmlmb3JtIGZsb2F0IGlzU2hhZG93TWFwOw0KCWV4dGVybiB1bmlmb3JtIGZsb2F0IF9fcmVmcmFjdHM7DQoNCglmbG9hdCB0aXIgPSAwOw0KCWlmKCBpb190cmFuc3BhcmVuY3kgIT0gY29sb3IoMCkgJiYNCgkgICAgX19yZWZyYWN0cyAhPSAwKQ0KCXsNCg0KDQoNCg0KI2xpbmUgNDkzICIuLi9yc2wvc2hhZGluZ191dGlscy5oIg0KCQlpZiggKDEgPT0gcmF5aW5mbyggInR5cGUiLCByYXlUeXBlICkgJiYgcmF5VHlwZSA9PSAidHJhbnNtaXNzaW9uIikgfHwNCgkJCSgxID09IGF0dHJpYnV0ZSggInVzZXI6U2hhZG93TWFwUmVuZGVyaW5nIiwgaXNTaGFkb3dNYXAgKSAmJg0KCQkJIGlzU2hhZG93TWFwICE9IDApICkNCgkJew0KCQkJb19yZWZyYWN0aW9uID0gMDsNCgkJCWlvX3RyYW5zcGFyZW5jeSAqPQ0KCQkJCW1peCggMSwgYWJzKCBub3JtYWxpemUoaV9JKSAuIGlfTiApLCBpX3NoYWRvd0F0dGVudWF0aW9uICk7DQoJCX0NCgkJZWxzZSBpZiggaV9yZWZyYWN0aW9ucyAhPSAwICkNCgkJew0KCQkJY29sb3IgcmVmcmFjdGlvbkNvbG9yID0gMDsNCg0KCQkJaWYoIHJheVNwZWN1bGFyRGVwdGgoKSA8IGlfcmVmcmFjdGlvbkxpbWl0ICkNCgkJCXsNCgkJCQlmbG9hdCBldGE7DQoJCQkJbm9ybWFsIE5mID0gaV9OOw0KDQoJCQkJaWYoIGlfSSAuIGlfTiA8IDAgKQ0KCQkJCXsNCgkJCQkJZXRhID0gMS4wIC8gaV9yZWZyYWN0aXZlSW5kZXg7DQoJCQkJCU5mID0gaV9OOw0KCQkJCX0gDQoJCQkJZWxzZSANCgkJCQl7DQoJCQkJCWV0YSA9IGlfcmVmcmFjdGl2ZUluZGV4Ow0KCQkJCQlOZiA9IC1pX047DQoJCQkJfQ0KDQoJCQkJdmVjdG9yIHJlZnJhY3QgPSByZWZyYWN0KG5vcm1hbGl6ZShpX0kpLCBOZiwgZXRhKTsNCg0KCQkJCWlmKCBsZW5ndGgoIHJlZnJhY3QgKSA8PSAxZS02ICkNCgkJCQl7DQoJCQkJCW9fcmVmcmFjdGlvbiA9IDA7DQoJCQkJCXRpciA9IDEuMDsNCgkJCQl9DQoJCQkJZWxzZQ0KCQkJCXsNCgkJCQkJY29sb3IgdHJzID0gMDsNCgkJCQkJdmVjdG9yIGRpciA9IG5vcm1hbGl6ZShyZWZyYWN0KTsNCg0KCQkJCQlyZWZyYWN0aW9uQ29sb3IgPSB0cmFjZSgNCgkJCQkJCQlQLCBkaXIsDQoJCQkJCQkJInN1YnNldCIsICItXzNkZm1fbm90X3Zpc2libGVfaW5fcmVmcmFjdGlvbnMiLCANCgkJCQkJCQkidHJhbnNtaXNzaW9uIiwgdHJzKTsNCg0KCQkJCQl1bmlmb3JtIGZsb2F0IGFkZF90b19maW5hbF9taXggPSBnZXRHaUFkZFRvRmluYWxNaXgoKTsNCgkJCQkJaWYoIHRycyAhPSAwICYmIGFkZF90b19maW5hbF9taXggPiAwKQ0KCQkJCQl7DQoJCQkJCQlyZWZyYWN0aW9uQ29sb3IgKz0gZ2V0R2lFbnZpcm9ubWVudFNwZWN1bGFyKGRpciwgMCwgMCkgKiB0cnM7DQoJCQkJCX0NCgkJCQl9DQoJCQl9DQoNCgkJCW9fcmVmcmFjdGlvbiA9IGlvX3RyYW5zcGFyZW5jeSAqIHJlZnJhY3Rpb25Db2xvcjsNCgkJCWlvX3RyYW5zcGFyZW5jeSA9IDA7DQoJCX0NCgkJZWxzZQ0KCQl7DQoJCQlvX3JlZnJhY3Rpb24gPSAwOw0KCQl9DQoJfQ0KCWVsc2UNCgl7DQoJCW9fcmVmcmFjdGlvbiA9IDA7DQoJfQ0KDQoJcmV0dXJuIHRpcjsNCn0NCg0KZmxvYXQgY29tcHV0ZVNoYWRvd1ZhbHVlKG5vcm1hbCBpX04pDQp7DQoJZmxvYXQgc2hhZG93VmFsdWUgPSAwOw0KCXZhcnlpbmcgZmxvYXQgdG90YWxMaWdodEludGVuc2l0eSA9IDA7DQoNCglleHRlcm4gdmFyeWluZyBwb2ludCBQOw0KCWlsbHVtaW5hbmNlKFApDQoJew0KDQoNCiNsaW5lIDU3MiAiLi4vcnNsL3NoYWRpbmdfdXRpbHMuaCINCgkJaWYoIEwuaV9OID49IDAgKQ0KCQl7DQoJCQlmbG9hdCBfXzNkZm1fc2hhZG93aW5nID0gMDsNCgkJCWNvbG9yIF9fM2RmbV91bnNoYWRvd2VkX2NsID0gMDsNCg0KCQkJbGlnaHRzb3VyY2UoIl9fM2RmbV9zaGFkb3dpbmciLCBfXzNkZm1fc2hhZG93aW5nKTsNCgkJCWxpZ2h0c291cmNlKCJfXzNkZm1fdW5zaGFkb3dlZF9jbCIsIF9fM2RmbV91bnNoYWRvd2VkX2NsKTsNCgkJCWZsb2F0IHVuc2hhZG93ZWRfaW50ZW5zaXR5ID0gbHVtaW5hbmNlKF9fM2RmbV91bnNoYWRvd2VkX2NsKTsNCg0KCQkJc2hhZG93VmFsdWUgKz0gX18zZGZtX3NoYWRvd2luZyAqIHVuc2hhZG93ZWRfaW50ZW5zaXR5Ow0KCQkJdG90YWxMaWdodEludGVuc2l0eSArPSB1bnNoYWRvd2VkX2ludGVuc2l0eTsNCgkJfQ0KCX0NCg0KCXNoYWRvd1ZhbHVlIC89IHRvdGFsTGlnaHRJbnRlbnNpdHk7DQogIHJldHVybiBzaGFkb3dWYWx1ZTsNCn0NCg0Kdm9pZCBjb21wdXRlU2hhZG93UGFzcyhub3JtYWwgaV9OKQ0Kew0KDQoNCg0KDQp9DQoNCmNvbG9yIGNvbXB1dGVMdW1pbmFuY2VEZXB0aCgpDQp7DQoJdW5pZm9ybSBmbG9hdCBuZWFyX2ZhclsyXSA9IHswLCAxZTN9Ow0KCW9wdGlvbiggIkNsaXBwaW5nIiwgbmVhcl9mYXIgKTsNCg0KCXVuaWZvcm0gZmxvYXQgbmVhciA9IG5lYXJfZmFyWzBdOw0KCXVuaWZvcm0gZmxvYXQgZmFyID0gbmVhcl9mYXJbMV07DQoNCglleHRlcm4gdmFyeWluZyB2ZWN0b3IgSTsNCglmbG9hdCBkZXB0aCA9IGxlbmd0aChJKSAtIG5lYXI7DQoNCglmYXIgLT0gbmVhcjsNCglkZXB0aCA9IChmYXIgLSBkZXB0aCkgLyBmYXI7DQoNCglyZXR1cm4gY29sb3IoZGVwdGgsIGRlcHRoLCBkZXB0aCk7DQp9DQoNCmNvbG9yIGdldFBob25nKA0KCW5vcm1hbCBpX047IHZlY3RvciBpX1Y7IGZsb2F0IGlfc2l6ZTsgDQoJdW5pZm9ybSBmbG9hdCBpX2tleUxpZ2h0c09ubHksIHVuc2hhZG93ZWQpDQp7DQoJY29sb3IgQyA9IDA7DQoJdmVjdG9yIFIgPSByZWZsZWN0KCAtbm9ybWFsaXplKGlfViksIG5vcm1hbGl6ZShpX04pICk7DQoJZXh0ZXJuIHZhcnlpbmcgcG9pbnQgUDsNCg0KCWlsbHVtaW5hbmNlKCBQLCBpX04sIFBJLzIgKQ0KCXsNCgkJZmxvYXQgaXNLZXlMaWdodCA9IDE7DQoNCgkJaWYoIGlfa2V5TGlnaHRzT25seSAhPSAwICkNCgkJew0KCQkJbGlnaHRzb3VyY2UoICJpc2tleWxpZ2h0IiwgaXNLZXlMaWdodCApOw0KCQl9DQoNCgkJaWYoIGlzS2V5TGlnaHQgIT0gMCApDQoJCXsNCgkJCWZsb2F0IG5vbnNwZWN1bGFyID0gMDsNCgkJCWxpZ2h0c291cmNlKCAiX19ub25zcGVjdWxhciIsIG5vbnNwZWN1bGFyICk7DQoNCgkJCWlmKCBub25zcGVjdWxhciA8IDEgKQ0KCQkJew0KCQkJCXZlY3RvciBMbiA9IG5vcm1hbGl6ZShMKTsNCg0KCQkJCXZhcnlpbmcgY29sb3IgY3VyX2NsOw0KCQkJCXsgY3VyX2NsID0gQ2w7IGlmKCB1bnNoYWRvd2VkICE9IDAgKSBsaWdodHNvdXJjZSgiX18zZGZtX3Vuc2hhZG93ZWRfY2wiLCBjdXJfY2wpOyB9Ow0KCQkJCUMgKz0gY3VyX2NsICogcG93KG1heCgwLjAsUi5MbiksIGlfc2l6ZSkgKiAoMS1ub25zcGVjdWxhcik7DQoJCQl9DQoJCX0NCgl9DQoJcmV0dXJuIEM7DQp9DQoNCg0KY29sb3IgZ2V0UGhvbmdTKA0KCW5vcm1hbCBpX047IHZlY3RvciBpX1Y7IGZsb2F0IGlfc2l6ZTsgDQoJdW5pZm9ybSBmbG9hdCBpX2tleUxpZ2h0c09ubHksIHVuc2hhZG93ZWQpDQp7DQoJY29sb3IgQyA9IDA7DQoJZXh0ZXJuIHZhcnlpbmcgcG9pbnQgUDsNCg0KCWlsbHVtaW5hbmNlKCBQLCBpX04sIFBJLzIgKQ0KCXsNCgkJdmVjdG9yIEggPSBub3JtYWxpemUobm9ybWFsaXplKEwpK2lfVik7DQoJCWZsb2F0IGlzS2V5TGlnaHQgPSAxOw0KDQoJCWlmKCBpX2tleUxpZ2h0c09ubHkgIT0gMCApDQoJCXsNCgkJCWxpZ2h0c291cmNlKCAiaXNrZXlsaWdodCIsIGlzS2V5TGlnaHQgKTsNCgkJfQ0KDQoJCWlmKCBpc0tleUxpZ2h0ICE9IDAgKQ0KCQl7DQoJCQlmbG9hdCBub25zcGVjdWxhciA9IDA7DQoJCQlsaWdodHNvdXJjZSggIl9fbm9uc3BlY3VsYXIiLCBub25zcGVjdWxhciApOw0KDQoJCQlpZiggbm9uc3BlY3VsYXIgPCAxICkNCgkJCXsNCgkJCQl2ZWN0b3IgTG4gPSBub3JtYWxpemUoTCk7DQoNCgkJCQl2YXJ5aW5nIGNvbG9yIGN1cl9jbDsNCgkJCQl7IGN1cl9jbCA9IENsOyBpZiggdW5zaGFkb3dlZCAhPSAwICkgbGlnaHRzb3VyY2UoIl9fM2RmbV91bnNoYWRvd2VkX2NsIiwgY3VyX2NsKTsgfTsNCgkJCQlDICs9IGN1cl9jbCAqIHBvdyhtYXgoMC4wLGlfTi5IKSwgaV9zaXplKSAqICgxLW5vbnNwZWN1bGFyKTsNCgkJCX0NCgkJfQ0KCX0NCglyZXR1cm4gQzsNCn0NCg0KY29sb3IgZ2V0UGhvbmdFKHZlY3RvciBpX1I7IGZsb2F0IGlfaGlnaGxpZ2h0X3NpemUsIGlfcm91Z2huZXNzOw0KCXVuaWZvcm0gZmxvYXQgaV9rZXlMaWdodHNPbmx5LCB1bnNoYWRvd2VkKQ0Kew0KCWV4dGVybiBwb2ludCBQOw0KCXZhcnlpbmcgY29sb3IgQyA9IDA7DQoNCglpbGx1bWluYW5jZSggInNwZWN1bGFyIiwgUCwgaV9SLCBpX2hpZ2hsaWdodF9zaXplICogUEkvMiApDQoJew0KCQlmbG9hdCBpc0tleUxpZ2h0ID0gMTsNCg0KCQlpZiggaV9rZXlMaWdodHNPbmx5ICE9IDAgKQ0KCQl7DQoJCQlsaWdodHNvdXJjZSggImlza2V5bGlnaHQiLCBpc0tleUxpZ2h0ICk7DQoJCX0NCg0KCQlpZiggaXNLZXlMaWdodCAhPSAwICkNCgkJew0KCQkJZmxvYXQgbm9uc3BlY3VsYXIgPSAwOw0KCQkJbGlnaHRzb3VyY2UoICJfX25vbnNwZWN1bGFyIiwgbm9uc3BlY3VsYXIgKTsNCg0KCQkJaWYoIG5vbnNwZWN1bGFyIDwgMSApDQoJCQl7DQoJCQkJZmxvYXQgY29zX2FuZ2xlID0gbm9ybWFsaXplKEwpIC4gaV9SOw0KCQkJCWZsb2F0IGFuZ2xlID0gYWNvcyhjb3NfYW5nbGUpOw0KDQoJCQkJZmxvYXQgc3BlYyA9IHBvdyggY29zKGFuZ2xlIC8gaV9oaWdobGlnaHRfc2l6ZSksIHBvdyhpX3JvdWdobmVzcywgLTIpICk7DQoNCgkJCQl2YXJ5aW5nIGNvbG9yIGN1cl9jbDsNCgkJCQl7IGN1cl9jbCA9IENsOyBpZiggdW5zaGFkb3dlZCAhPSAwICkgbGlnaHRzb3VyY2UoIl9fM2RmbV91bnNoYWRvd2VkX2NsIiwgY3VyX2NsKTsgfTsNCgkJCQlDICs9IHNwZWMgKiBjdXJfY2wgKiAoMS1ub25zcGVjdWxhcik7DQoJCQl9DQoJCX0NCgl9DQoJcmV0dXJuIEM7DQp9DQoNCmNvbG9yIGdldEdhdXNzaWFuKHZlY3RvciBpX0k7IHZlY3RvciBpX047IGZsb2F0IGlfcm91Z2huZXNzOw0KCXVuaWZvcm0gZmxvYXQgaV9rZXlMaWdodHNPbmx5LCB1bnNoYWRvd2VkKQ0Kew0KCWV4dGVybiBwb2ludCBQOw0KCWNvbG9yIEMgPSAwOw0KDQoJaWxsdW1pbmFuY2UoICJzcGVjdWxhciIsIFAgKQ0KCXsNCgkJZmxvYXQgaXNLZXlMaWdodCA9IDE7DQoNCgkJaWYoIGlfa2V5TGlnaHRzT25seSAhPSAwICkNCgkJew0KCQkJbGlnaHRzb3VyY2UoICJpc2tleWxpZ2h0IiwgaXNLZXlMaWdodCApOw0KCQl9DQoNCgkJaWYoIGlzS2V5TGlnaHQgIT0gMCApDQoJCXsNCgkJCWZsb2F0IG5vbnNwZWN1bGFyID0gMDsNCgkJCWxpZ2h0c291cmNlKCAiX19ub25zcGVjdWxhciIsIG5vbnNwZWN1bGFyICk7DQoNCgkJCWlmKCBub25zcGVjdWxhciA8IDEgKQ0KCQkJew0KCQkJCXZlY3RvciBMbiA9IG5vcm1hbGl6ZShMKTsNCgkJCQl2ZWN0b3IgSG4gPSBub3JtYWxpemUoLWlfSSArIExuKTsNCg0KCQkJCWZsb2F0IHNwZWMgPSBleHAoIC1zcSggYWNvcyhpX04uSG4pIC8gaV9yb3VnaG5lc3MgKSApOw0KDQoJCQkJdmFyeWluZyBjb2xvciBjdXJfY2w7DQoJCQkJeyBjdXJfY2wgPSBDbDsgaWYoIHVuc2hhZG93ZWQgIT0gMCApIGxpZ2h0c291cmNlKCJfXzNkZm1fdW5zaGFkb3dlZF9jbCIsIGN1cl9jbCk7IH07DQoNCgkJCQlDICs9IGN1cl9jbCAqIHNwZWMgKiAoMS1ub25zcGVjdWxhcik7DQoJCQl9DQoJCX0NCgl9DQoJcmV0dXJuIEM7DQp9DQoNCmNvbG9yIGdldEdhdXNzaWFuRyh2ZWN0b3IgaV9JOyB2ZWN0b3IgaV9OOyBmbG9hdCBpX3JvdWdobmVzczsNCgl1bmlmb3JtIGZsb2F0IGlfa2V5TGlnaHRzT25seSwgdW5zaGFkb3dlZCkNCnsNCglleHRlcm4gcG9pbnQgUDsNCgljb2xvciBDID0gMDsNCg0KCWlsbHVtaW5hbmNlKCAic3BlY3VsYXIiLCBQICkNCgl7DQoJCWZsb2F0IGlzS2V5TGlnaHQgPSAxOw0KDQoJCWlmKCBpX2tleUxpZ2h0c09ubHkgIT0gMCApDQoJCXsNCgkJCWxpZ2h0c291cmNlKCAiaXNrZXlsaWdodCIsIGlzS2V5TGlnaHQgKTsNCgkJfQ0KDQoJCWlmKCBpc0tleUxpZ2h0ICE9IDAgKQ0KCQl7DQoJCQlmbG9hdCBub25zcGVjdWxhciA9IDA7DQoJCQlsaWdodHNvdXJjZSggIl9fbm9uc3BlY3VsYXIiLCBub25zcGVjdWxhciApOw0KDQoJCQlpZiggbm9uc3BlY3VsYXIgPCAxICkNCgkJCXsNCgkJCQl2ZWN0b3IgTG4gPSBub3JtYWxpemUoTCk7DQoJCQkJdmVjdG9yIEhuID0gbm9ybWFsaXplKC1pX0kgKyBMbik7DQoNCgkJCQlmbG9hdCBzcGVjID0gZXhwKCAtc3EoIGFjb3MoaV9OLkhuKSAvIGlfcm91Z2huZXNzICkgKTsNCgkJCQlzcGVjID0gc21vb3Roc3RlcCgwLCAxLzMsIHNwZWMpOw0KDQoJCQkJdmFyeWluZyBjb2xvciBjdXJfY2w7DQoJCQkJeyBjdXJfY2wgPSBDbDsgaWYoIHVuc2hhZG93ZWQgIT0gMCApIGxpZ2h0c291cmNlKCJfXzNkZm1fdW5zaGFkb3dlZF9jbCIsIGN1cl9jbCk7IH07DQoNCgkJCQlDICs9IGN1cl9jbCAqIHNwZWMgKiAoMS1ub25zcGVjdWxhcik7DQoJCQl9DQoJCX0NCgl9DQoJcmV0dXJuIEM7DQp9DQoNCmNvbG9yIGdldENvb2tUb3JyKHZlY3RvciBpX1Y7IHZlY3RvciBpX047IGZsb2F0IGlfcm91Z2huZXNzOyBjb2xvciBpX2lvcjsNCgl1bmlmb3JtIGZsb2F0IGlfa2V5TGlnaHRzT25seSwgdW5zaGFkb3dlZCkNCnsNCglleHRlcm4gcG9pbnQgUDsNCg0KCWZsb2F0IGV0YXIgPSAxL2lfaW9yWzBdOw0KCWZsb2F0IGV0YWcgPSAxL2lfaW9yWzFdOw0KCWZsb2F0IGV0YWIgPSAxL2lfaW9yWzJdOw0KCWZsb2F0IEt0LCBLcnIsIEtyZywgS3JiOw0KCWZyZXNuZWwoLWlfViwgaV9OLCBldGFyLCBLcnIsIEt0KTsNCglmcmVzbmVsKC1pX1YsIGlfTiwgZXRhZywgS3JnLCBLdCk7DQoJZnJlc25lbCgtaV9WLCBpX04sIGV0YWIsIEtyYiwgS3QpOw0KDQoJY29sb3IgRiA9IGNvbG9yKEtyciwgS3JnLCBLcmIpOw0KDQoJY29sb3IgQyA9IDA7DQoNCglpbGx1bWluYW5jZSggUCwgaV9OLCBQSS8yKQ0KCXsNCgkJZmxvYXQgaXNLZXlMaWdodCA9IDE7DQoNCgkJaWYoIGlfa2V5TGlnaHRzT25seSAhPSAwICkNCgkJew0KCQkJbGlnaHRzb3VyY2UoICJpc2tleWxpZ2h0IiwgaXNLZXlMaWdodCApOw0KCQl9DQoNCgkJaWYoIGlzS2V5TGlnaHQgIT0gMCApDQoJCXsNCgkJCWZsb2F0IG5vbnNwZWN1bGFyID0gMDsNCgkJCWxpZ2h0c291cmNlKCAiX19ub25zcGVjdWxhciIsIG5vbnNwZWN1bGFyICk7DQoNCgkJCWlmKCBub25zcGVjdWxhciA8IDEgKQ0KCQkJew0KCQkJCXZlY3RvciBMbiA9IG5vcm1hbGl6ZShMKTsNCgkJCQl2ZWN0b3IgSG4gPSBub3JtYWxpemUoaV9WICsgTG4pOw0KCQkJCWZsb2F0IE5IID0gaV9OLkhuOw0KCQkJCWZsb2F0IGFscGhhID0gYWNvcyhOSCk7DQoJCQkJZmxvYXQgTlYgPSBpX04uaV9WOw0KCQkJCWZsb2F0IE5MID0gaV9OLkxuOw0KCQkJCWZsb2F0IEhWID0gSG4uaV9WOw0KDQoNCgkJCQlmbG9hdCBHMSA9ICgyICogTkggKiBOVikgLyBIVjsNCgkJCQlmbG9hdCBHMiA9ICgyICogTkggKiBOTCkgLyBIVjsgICAgICAgICANCgkJCQlmbG9hdCBHID0gbWluKDEsIG1pbihHMSwgRzIpKTsNCg0KDQoJCQkJZmxvYXQgX0QgPSB0YW4oYWxwaGEpIC8gaV9yb3VnaG5lc3M7DQoJCQkJZmxvYXQgRCA9IGV4cCggLSAoX0QqX0QpICkgLyANCgkJCQkJKDQuMCAqIGlfcm91Z2huZXNzICogaV9yb3VnaG5lc3MgKiBwb3coY29zKGFscGhhKSwgNC4wKSk7DQoNCgkJCQljb2xvciBzcGVjID0gRCpHKkYvTlY7DQoNCgkJCQl2YXJ5aW5nIGNvbG9yIGN1cl9jbDsNCgkJCQl7IGN1cl9jbCA9IENsOyBpZiggdW5zaGFkb3dlZCAhPSAwICkgbGlnaHRzb3VyY2UoIl9fM2RmbV91bnNoYWRvd2VkX2NsIiwgY3VyX2NsKTsgfTsNCg0KCQkJCUMgKz0gY3VyX2NsICogc3BlYyAqICgxLW5vbnNwZWN1bGFyKTsNCgkJCX0NCgkJfQ0KCX0NCg0KCXJldHVybiBDOw0KfQ0KDQp2b2lkIGRvX2J1bXBfbWFwKA0KCWZsb2F0IGlfYnVtcFZhbHVlOw0KCWZsb2F0IGlfYnVtcERlcHRoOw0KCW5vcm1hbCBpX25vcm1hbENhbWVyYTsNCglvdXRwdXQgbm9ybWFsIG9fb3V0Tm9ybWFsICkNCnsNCglleHRlcm4gdmVjdG9yIGRQZHUsIGRQZHY7DQoNCglmbG9hdCBkZXB0aCA9IGFicyhpX2J1bXBEZXB0aCk7DQoJZmxvYXQgb2Zmc2V0ID0gY2xhbXAoaV9idW1wVmFsdWUgKiBpX2J1bXBEZXB0aCwgLWRlcHRoLCBkZXB0aCk7DQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCiNsaW5lIDg5OSAiLi4vcnNsL3NoYWRpbmdfdXRpbHMuaCINCglleHRlcm4gcG9pbnQgUDsNCglleHRlcm4gbm9ybWFsIE5nOw0KDQoJbm9ybWFsIE5uID0gbm9ybWFsaXplKGlfbm9ybWFsQ2FtZXJhKTsNCglub3JtYWwgTmduID0gbm9ybWFsaXplKE5nKTsNCglub3JtYWwgTm9mZnNldCA9IE5uIC0gTmduOw0KDQoJZmxvYXQgc2NhbGUgPSAwLjI1Ow0KDQoJcG9pbnQgUHAgPQ0KCQl0cmFuc2Zvcm0oIndvcmxkIiwgUCkgKw0KCQlub3JtYWxpemUobnRyYW5zZm9ybSgid29ybGQiLCBOZ24pKSAqIG9mZnNldCAqIHNjYWxlOw0KCU5uID0gLW50cmFuc2Zvcm0oIndvcmxkIiwgImN1cnJlbnQiLCBjYWxjdWxhdGVub3JtYWwoUHApKTsNCglObiA9IG5vcm1hbGl6ZShObik7DQoJb19vdXROb3JtYWwgPSBub3JtYWxpemUoTm4gKyBOb2Zmc2V0KTsNCg0KDQp9DQoNCg0KDQoNCg0KDQoNCg0KDQoNCiNsaW5lIDk2NSAiLi4vcnNsL3NoYWRpbmdfdXRpbHMuaCINCmZsb2F0IHJvdWdobmVzcyhmbG9hdCBnbG9zcykNCnsNCglyZXR1cm4gcG93KDIuMCwgOC4wICogZ2xvc3MpOw0KfQ0KDQoNCg0KDQoNCg0KDQoNCiNsaW5lIDk3NyAiLi4vcnNsL3NoYWRpbmdfdXRpbHMuaCINCmNvbG9yDQpMb2NJbGx1bU9yZW5OYXlhciAoDQoJbm9ybWFsIE47DQoJdmVjdG9yIFY7DQoJZmxvYXQgcm91Z2huZXNzOw0KCXVuaWZvcm0gZmxvYXQga2V5TGlnaHRzT25seTsgDQoJdW5pZm9ybSBmbG9hdCB1bnNoYWRvd2VkOykNCnsNCg0KCWZsb2F0IHNpZ21hMiA9IHJvdWdobmVzcyAqIHJvdWdobmVzczsNCglmbG9hdCBBID0gMSAtIDAuNSAqIHNpZ21hMiAvIChzaWdtYTIgKyAwLjMzKTsNCglmbG9hdCBCID0gMC40NSAqIHNpZ21hMiAvIChzaWdtYTIgKyAwLjA5KTsNCg0KCWZsb2F0ICB0aGV0YV9yID0gYWNvcyAoViAuIE4pOyAgICAgICAgIA0KCXZlY3RvciBWX3BlcnBfTiA9IG5vcm1hbGl6ZShWLU4qKFYuTikpOyAgDQoNCg0KCWNvbG9yICBDID0gMDsNCglleHRlcm4gcG9pbnQgUDsNCglpbGx1bWluYW5jZSAoUCwgTiwgUEkvMikNCgl7DQoJCWZsb2F0IGlzS2V5TGlnaHQgPSAxOw0KDQoJCWlmKCBrZXlMaWdodHNPbmx5ICE9IDAgKQ0KCQl7DQoJCQlsaWdodHNvdXJjZSggImlza2V5bGlnaHQiLCBpc0tleUxpZ2h0ICk7DQoJCX0NCg0KCQlpZiggaXNLZXlMaWdodCAhPSAwICkNCgkJew0KDQoJCQlleHRlcm4gdmVjdG9yIEw7DQoJCQl1bmlmb3JtIGZsb2F0IG5vbmRpZmYgPSAwOw0KCQkJbGlnaHRzb3VyY2UgKCJfX25vbmRpZmZ1c2UiLCBub25kaWZmKTsNCgkJCWlmIChub25kaWZmID09IDApDQoJCQl7DQoJCQkJdmVjdG9yIExOID0gbm9ybWFsaXplKEwpOw0KCQkJCWZsb2F0IGNvc190aGV0YV9pID0gTE4gLiBOOw0KCQkJCWZsb2F0IGNvc19waGlfZGlmZiA9IFZfcGVycF9OIC4gbm9ybWFsaXplKExOIC0gTipjb3NfdGhldGFfaSk7DQoJCQkJZmxvYXQgdGhldGFfaSA9IGFjb3MgKGNvc190aGV0YV9pKTsNCgkJCQlmbG9hdCBhbHBoYSA9IG1heCAodGhldGFfaSwgdGhldGFfcik7DQoJCQkJZmxvYXQgYmV0YSA9IG1pbiAodGhldGFfaSwgdGhldGFfcik7DQoJCQkJdmFyeWluZyBjb2xvciBjdXJfY2w7DQoJCQkJeyBjdXJfY2wgPSBDbDsgaWYoIHVuc2hhZG93ZWQgIT0gMCApIGxpZ2h0c291cmNlKCJfXzNkZm1fdW5zaGFkb3dlZF9jbCIsIGN1cl9jbCk7IH07DQoJCQkJQyArPSBjdXJfY2wgKiBjb3NfdGhldGFfaSAqIA0KCQkJCShBICsgQiAqIG1heCgwLGNvc19waGlfZGlmZikgKiBzaW4oYWxwaGEpICogdGFuKGJldGEpKTsNCgkJCX0NCgkJfQ0KCX0NCglyZXR1cm4gQzsNCn0NCg0KDQpmbG9hdCBjb21wdXRlX3NhbXBsaW5nX2FuZ2xlKCBmbG9hdCBnbG9zc2luZXNzOyApDQp7DQoJaWYoIGdsb3NzaW5lc3MgPj0gMS4wICkNCgkJcmV0dXJuIDAuMDsNCgllbHNlDQogICAgcmV0dXJuICgxLjAgLSBwb3coY2xhbXAoZ2xvc3NpbmVzcywgMC4wLCAxLjApLCAwLjIpKSAqIFBJIC8gMi4wOw0KfQ0KDQpjb2xvciB0cmFjZV9yZWZsZWN0aW9uKA0KCXZlY3RvciBJbjsNCglub3JtYWwgTmY7DQoJdmVjdG9yIFY7DQoJZmxvYXQgaV9yZWZsX2dsb3NzOw0KCWZsb2F0IGlfcmVmbF9nbG9zc19zYW1wbGVzOw0KCWZsb2F0IGlfdXNlX21heF9kaXN0Ow0KCWZsb2F0IGlfbWF4X2Rpc3Q7DQoJdW5pZm9ybSBmbG9hdCBpX2RvX3JlZmxfZmFsbG9mZjsNCgl2YXJ5aW5nIGNvbG9yIGlfcmVmbF9mYWxsb2ZmX2NvbG9yOw0KCXZhcnlpbmcgY29sb3IgaV93ZWlnaHQgKQ0Kew0KCWV4dGVybiBwb2ludCBQOw0KCWV4dGVybiB1bmlmb3JtIGZsb2F0IF9fcmVmbGVjdHM7DQoNCglpZiggX19yZWZsZWN0cyA9PSAwICkNCgl7DQoJCXJldHVybiBjb2xvcigwKTsNCgl9DQoNCg0KCWZsb2F0IHNhbXBsZV9hbmdsZSA9IGNvbXB1dGVfc2FtcGxpbmdfYW5nbGUoIGlfcmVmbF9nbG9zcyApOw0KCWZsb2F0IHNhbXBsZV9jb3VudCA9IChpX3JlZmxfZ2xvc3MgPT0gMCkgPw0KCQltaW4oNCwgaV9yZWZsX2dsb3NzX3NhbXBsZXMpIDogaV9yZWZsX2dsb3NzX3NhbXBsZXM7DQoNCg0KCXZlY3RvciByZWZsX2RpciA9IHJlZmxlY3QoSW4sIE5mKTsNCg0KCXVuaWZvcm0gZmxvYXQgbWF4X2Rpc3QgPSBpX3VzZV9tYXhfZGlzdCA+IDFlLTYgPyBpX21heF9kaXN0IDogMWUzODsNCg0KCWNvbG9yIHRycyA9IDA7DQoJZmxvYXQgZGlzdCA9IDA7DQoNCglmbG9hdCBmYWRlID0gMS4wOw0KCWlmKCBpX3VzZV9tYXhfZGlzdCAhPSAwICkNCgl7DQoJCWZhZGUgPSBwb3coICggY2xhbXAoIDEgLSBkaXN0IC8gbWF4X2Rpc3QsIDAsIDEgKSApLCAyICk7DQoJfQ0KDQoJY29sb3IgcmVmbGVjdGlvbiA9IHRyYWNlKCANCgkJUCwgcmVmbF9kaXIsIGRpc3QsIA0KCQkic2FtcGxlY29uZSIsIHNhbXBsZV9hbmdsZSwNCgkJInNhbXBsZXMiLCBzYW1wbGVfY291bnQsIA0KCQkidHJhbnNtaXNzaW9uIiwgdHJzLCANCgkJInN1YnNldCIsICItXzNkZm1fbm90X3Zpc2libGVfaW5fcmVmbGVjdGlvbnMiLA0KCQkibWF4ZGlzdCIsIG1heF9kaXN0LA0KCQkid2VpZ2h0IiwgaV93ZWlnaHQqZmFkZSApOw0KDQoJcmVmbGVjdGlvbiAqPSBmYWRlOw0KDQoJZXh0ZXJuIGNvbG9yIF9fdHJhbnNwYXJlbmN5OwkNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KCWlmKCB0cnMgIT0gMCApDQoJew0KCQljb2xvciBlbnZfY29sb3IgPSAwOw0KDQoJCWlmKCBpX2RvX3JlZmxfZmFsbG9mZiAhPSAwICkNCgkJew0KCQkJZW52X2NvbG9yID0gaV9yZWZsX2ZhbGxvZmZfY29sb3I7DQoJCX0NCgkJZWxzZQ0KCQl7DQoJCQllbnZfY29sb3IgPSBnZXRHaUVudmlyb25tZW50U3BlY3VsYXIocmVmbF9kaXIsIHNhbXBsZV9jb3VudCwgc2FtcGxlX2FuZ2xlKTsNCgkJfQ0KDQoJCWlmKCBpX3VzZV9tYXhfZGlzdCAhPSAwICkNCgkJew0KCQkJZW52X2NvbG9yICo9ICgxIC0gZmFkZSk7DQoJCX0NCg0KCQllbnZfY29sb3IgKj0gdHJzOw0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCgkJcmVmbGVjdGlvbiArPSBlbnZfY29sb3I7DQoJfQ0KDQoJcmV0dXJuIHJlZmxlY3Rpb247DQp9DQoNCmNvbG9yIHRyYWNlX3JlZnJhY3Rpb24oDQoJbm9ybWFsIE5uOw0KCXZlY3RvciBJbjsNCglub3JtYWwgTmY7DQoJdmVjdG9yIFY7DQoJZmxvYXQgaV9yZWZyX2lvcjsNCglmbG9hdCBpX3JlZnJfZ2xvc3M7DQoJZmxvYXQgaV9yZWZyX2dsb3NzX3NhbXBsZXM7DQoJb3V0cHV0IGZsb2F0IG9fdG90YWxfaW50ZXJuYWxfcmVmbDsNCgl2YXJ5aW5nIGNvbG9yIGlfd2VpZ2h0ICkNCnsNCglleHRlcm4gcG9pbnQgUDsNCglleHRlcm4gdW5pZm9ybSBmbG9hdCBfX3JlZnJhY3RzOw0KDQoJaWYoIF9fcmVmcmFjdHMgPT0gMCApDQoJew0KCQlvX3RvdGFsX2ludGVybmFsX3JlZmwgPSAwOw0KCQlyZXR1cm4gY29sb3IoMCk7DQoJfQ0KDQoNCglmbG9hdCBzYW1wbGVfYW5nbGUgPSBjb21wdXRlX3NhbXBsaW5nX2FuZ2xlKCBpX3JlZnJfZ2xvc3MgKTsNCglmbG9hdCBzYW1wbGVfY291bnQgPSAoaV9yZWZyX2dsb3NzID09IDApID8NCgkJbWluKDQsIGlfcmVmcl9nbG9zc19zYW1wbGVzKSA6IGlfcmVmcl9nbG9zc19zYW1wbGVzOw0KDQoNCglmbG9hdCBldGEgPSAoSW4gLiBObiA8IDAuMCkgPyAxLjAgLyBpX3JlZnJfaW9yIDogaV9yZWZyX2lvcjsNCgl2ZWN0b3IgcmVmcl9kaXIgPSByZWZyYWN0KEluLCBOZiwgZXRhKTsNCgljb2xvciByZWZyYWN0aW9uID0gMDsNCg0KCWlmKCBsZW5ndGgoIHJlZnJfZGlyICkgPD0gMWUtNiApDQoJew0KCQlvX3RvdGFsX2ludGVybmFsX3JlZmwgPSAxOw0KCQlyZWZyYWN0aW9uID0gMDsNCgl9DQoJZWxzZQ0KCXsNCgkJY29sb3IgdHJzID0gMDsNCgkJcmVmcmFjdGlvbiA9IHRyYWNlKCANCgkJCVAsIHJlZnJfZGlyLCANCgkJCSJzYW1wbGVjb25lIiwgc2FtcGxlX2FuZ2xlLA0KCQkJInNhbXBsZXMiLCBzYW1wbGVfY291bnQsDQoJCQkic3Vic2V0IiwgIi1fM2RmbV9ub3RfdmlzaWJsZV9pbl9yZWZyYWN0aW9ucyIsIA0KCQkJInRyYW5zbWlzc2lvbiIsIHRycywNCgkJCSJ3ZWlnaHQiLCBpX3dlaWdodCApOw0KDQoJCWlmKCB0cnMgIT0gMCApDQoJCXsNCgkJCWNvbG9yIGVudl9jb2xvciA9IGdldEdpRW52aXJvbm1lbnRTcGVjdWxhcihyZWZyX2Rpciwgc2FtcGxlX2NvdW50LCBzYW1wbGVfYW5nbGUpOw0KCQkJcmVmcmFjdGlvbiArPSBlbnZfY29sb3IgKiB0cnM7DQoJCX0NCg0KCQlvX3RvdGFsX2ludGVybmFsX3JlZmwgPSAwOw0KCX0NCg0KCXJldHVybiByZWZyYWN0aW9uOw0KfQ0KDQoNCg0KDQoNCg0KDQoNCiNsaW5lIDEyMDYgIi4uL3JzbC9zaGFkaW5nX3V0aWxzLmgiDQpjb2xvciBzcGVjdWxhcl9oaWdobGlnaHQoDQoJdmVjdG9yIEluOw0KCW5vcm1hbCBOZjsNCgl2ZWN0b3IgVjsNCglmbG9hdCAgcmVmbF9yb3VnaG5lc3NfdSwgcmVmbF9yb3VnaG5lc3NfdjsNCgl1bmlmb3JtIGZsb2F0IGtleUxpZ2h0c09ubHk7IA0KCXVuaWZvcm0gZmxvYXQgdW5zaGFkb3dlZDspDQp7DQoJZXh0ZXJuIGNvbG9yIENsOw0KCWV4dGVybiB2ZWN0b3IgZFBkdSwgZFBkdjsNCglleHRlcm4gcG9pbnQgUDsNCg0KCXZlY3RvciB4ZGlyID0gbm9ybWFsaXplKCBkUGR1ICk7DQoJdmVjdG9yIHlkaXIgPSBub3JtYWxpemUoIGRQZHYgKTsNCg0KCXhkaXIgPSBub3JtYWxpemUoTmZeeGRpcl5OZik7DQogCXlkaXIgPSBub3JtYWxpemUoTmZeeWRpcl5OZik7DQoNCgljb2xvciBoaWdobGlnaHRzID0gMDsNCg0KDQoNCiNsaW5lIDEyMjggIi4uL3JzbC9zaGFkaW5nX3V0aWxzLmgiDQoJdW5pZm9ybSBmbG9hdCBjb21wb25lbnRfY29lZnNbM10gPSB7MC41LCAxLjAsIDEuNX07IA0KDQoJaWxsdW1pbmFuY2UoIFAsIE5mLCBQSSAqIDAuNSApDQoJew0KCQlmbG9hdCBpc0tleUxpZ2h0ID0gMTsNCg0KCQlpZigga2V5TGlnaHRzT25seSAhPSAwICkNCgkJew0KCQkJbGlnaHRzb3VyY2UoICJpc2tleWxpZ2h0IiwgaXNLZXlMaWdodCApOw0KCQl9DQoNCgkJaWYoIGlzS2V5TGlnaHQgIT0gMCApDQoJCXsNCgkJCXVuaWZvcm0gZmxvYXQgbm9uc3BlY3VsYXIgPSAwOw0KCQkJbGlnaHRzb3VyY2UoICJfX25vbnNwZWN1bGFyIiwgbm9uc3BlY3VsYXIgKTsNCg0KCQkJaWYoIG5vbnNwZWN1bGFyID09IDAgKQ0KCQkJew0KCQkJCXZlY3RvciBMbiA9IG5vcm1hbGl6ZShMKTsNCg0KCQkJCWZsb2F0IGRvdF9sbiA9IExuIC4gTmY7DQoJCQkJZmxvYXQgZG90X3ZuID0gViAuIE5mOw0KDQoJCQkJaWYoIGRvdF92bipkb3RfbG4+MC4wICkNCgkJCQl7DQoJCQkJCXZlY3RvciBIbiA9IG5vcm1hbGl6ZShWICsgTG4pOw0KCQkJCQlmbG9hdCBkb3RfaG4yID0gbWluKHNxKEhuIC4gTmYpLCAxLjApOw0KDQoJCQkJCWlmKCBkb3RfaG4yPjAuMCApDQoJCQkJCXsNCg0KCQkJCQkJZmxvYXQgazFfZGV2aWRlciA9IDEgLyAoc3FydChkb3Rfdm4gKiBkb3RfbG4pICogNC4wICogUEkpOyAgDQoJCQkJCQlmbG9hdCBzbW9vdGhfc3RlcF9sbiA9IHNtb290aHN0ZXAoIDAsIDAuMjUsIGRvdF9sbiApOw0KDQoJCQkJCQl1bmlmb3JtIGZsb2F0IGk9MDsNCgkJCQkJCXVuaWZvcm0gZmxvYXQgcm91Z2huZXNzX2NvZWYgPSAxOw0KDQoJCQkJCQlmb3IoIGk9MDsgaTwzOyBpKz0xLjAgKQ0KCQkJCQkJew0KDQoJCQkJCQkJZmxvYXQgazEgPQ0KCQkJCQkJCQkocmVmbF9yb3VnaG5lc3NfdSAqIHJlZmxfcm91Z2huZXNzX3YgKiByb3VnaG5lc3NfY29lZiAqIHJvdWdobmVzc19jb2VmICkNCgkJCQkJCQkJKiBrMV9kZXZpZGVyOw0KCQkJCQkJCWZsb2F0IGsyID0NCgkJCQkJCQkJc3EoSG4gLiB4ZGlyICogcmVmbF9yb3VnaG5lc3NfdSAqIHJvdWdobmVzc19jb2VmKQ0KCQkJCQkJCQkrIHNxKEhuIC4geWRpciAqIHJlZmxfcm91Z2huZXNzX3YgKiByb3VnaG5lc3NfY29lZik7DQoJCQkJCQkJY29sb3IgYyA9DQoJCQkJCQkJCWsxICogZXhwKC1rMiAvIGRvdF9objIpDQoJCQkJCQkJCSogZG90X2xuDQoJCQkJCQkJCSogc21vb3RoX3N0ZXBfbG47DQoNCgkJCQkJCQl2YXJ5aW5nIGNvbG9yIGN1cl9jbDsNCgkJCQkJCQl7IGN1cl9jbCA9IENsOyBpZiggdW5zaGFkb3dlZCAhPSAwICkgbGlnaHRzb3VyY2UoIl9fM2RmbV91bnNoYWRvd2VkX2NsIiwgY3VyX2NsKTsgfTsNCg0KCQkJCQkJCWhpZ2hsaWdodHMgKz0gY3VyX2NsICogYyAqIGNvbXBvbmVudF9jb2Vmc1tpXTsNCg0KCQkJCQkJCXJvdWdobmVzc19jb2VmICo9IDAuNTsNCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCX0NCgkJCX0NCgkJfQ0KCX0NCg0KCXJldHVybiBoaWdobGlnaHRzOw0KfQ0KDQoNCg0KDQojbGluZSAxMjk4ICIuLi9yc2wvc2hhZGluZ191dGlscy5oIg0KdmVjdG9yIG1vdGlvblZlY3RvcigpDQp7DQoJZXh0ZXJuIHBvaW50IFA7DQoJZXh0ZXJuIHZlY3RvciBkUGR0aW1lOw0KDQoJdmVjdG9yIG1vdGlvbiA9IGRQZHRpbWU7DQoNCglwb2ludCBQMCA9IHRyYW5zZm9ybSggInNjcmVlbiIsIFAgKTsNCglwb2ludCBQMSA9IHRyYW5zZm9ybSggInNjcmVlbiIsIFAgKyBtb3Rpb24gKTsNCg0KCXJldHVybiBQMCAtIFAxOw0KfQ0KDQoNCg0KDQojbGluZSA5ICJtYXlhX2dpX2xpZ2h0LnNsIg0KI2xpbmUgMSAiLi4vcnNsL2xpZ2h0X3V0aWxzLmgiDQoNCg0KDQoNCg0KDQoNCiNsaW5lIDEgIi4uL3JzbC91dGlscy5oIg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQojbGluZSAxMCAiLi4vcnNsL2xpZ2h0X3V0aWxzLmgiDQoNCmZsb2F0IHJlY2VpdmVfc2hhZG93cygpDQp7DQoJdW5pZm9ybSBmbG9hdCByZWNlaXZlX3NoYWQgPSAxOw0KCWF0dHJpYnV0ZSggInVzZXI6ZGVsaWdodF9yZWNlaXZlX3NoYWRvd3MiLCByZWNlaXZlX3NoYWQgKTsNCglyZXR1cm4gcmVjZWl2ZV9zaGFkOw0KfQ0KDQpjb2xvciBjb21wdXRlTGlnaHRDb2xvcigNCgljb2xvciBpX2NvbG9yOw0KCWNvbG9yIGlfc2hhZG93Q29sb3I7DQoJdW5pZm9ybSBzdHJpbmcgaV9zaGFkb3dtYXBOYW1lOw0KCXVuaWZvcm0gZmxvYXQgaV9zaGFkb3dCbHVyOw0KCXVuaWZvcm0gZmxvYXQgaV9zaGFkb3dTYW1wbGVzOw0KCXVuaWZvcm0gZmxvYXQgaV9kbWFwRmlsdGVyU2l6ZTsNCgl1bmlmb3JtIGZsb2F0IGlfZG1hcEJpYXM7DQoJKQ0Kew0KCWV4dGVybiBwb2ludCBQczsNCg0KCWNvbG9yIGxjb2xvciA9IGlfY29sb3I7DQoNCglpZiggaV9zaGFkb3dtYXBOYW1lICE9ICIiICYmIDEgPT0gcmVjZWl2ZV9zaGFkb3dzKCkgKQ0KCXsNCgkJY29sb3IgQ3NoYWQ7DQoNCgkJdW5pZm9ybSBmbG9hdCBmaWx0ZXJ3aWR0aCA9IGlfZG1hcEZpbHRlclNpemU7DQoJCXVuaWZvcm0gZmxvYXQgc2FtcGxlcyA9IGlfc2hhZG93U2FtcGxlczsNCg0KCQlpZiggaV9kbWFwRmlsdGVyU2l6ZSA+IDEgKQ0KCQl7DQoJCQl1bmlmb3JtIGZsb2F0IHNoYWRpbmdyYXRlID0gMTsNCgkJCWF0dHJpYnV0ZSgiU2hhZGluZ1JhdGUiLCBzaGFkaW5ncmF0ZSk7DQoNCgkJCWZpbHRlcndpZHRoID0gMi41ICogaV9kbWFwRmlsdGVyU2l6ZSAvIHNxcnQoc2hhZGluZ3JhdGUpOw0KCQkJaWYoIGZpbHRlcndpZHRoIDwgMSApDQoJCQl7DQoJCQkJZmlsdGVyd2lkdGggPSAxOw0KCQkJfQ0KDQoJCQlpZiggaV9kbWFwRmlsdGVyU2l6ZSA+IDIgKQ0KCQkJew0KCQkJCXNhbXBsZXMgKj0gMiArIGlfZG1hcEZpbHRlclNpemUgLyAxMDsNCgkJCX0NCgkJfQ0KDQoJCWlmKCBpX2RtYXBCaWFzID09IDApDQoJCXsNCgkJCUNzaGFkID0gc2hhZG93KA0KCQkJCWlfc2hhZG93bWFwTmFtZSwgUHMsDQoJCQkJImJsdXIiLCBpX3NoYWRvd0JsdXIsDQoJCQkJIndpZHRoIiwgZmlsdGVyd2lkdGgsDQoJCQkJInNhbXBsZXMiLCBzYW1wbGVzICk7DQoJCX0NCgkJZWxzZQ0KCQl7DQoJCQlDc2hhZCA9IHNoYWRvdygNCgkJCQlpX3NoYWRvd21hcE5hbWUsIFBzLA0KCQkJCSJiaWFzIiwgaV9kbWFwQmlhcywNCgkJCQkiYmx1ciIsIGlfc2hhZG93Qmx1ciwNCgkJCQkid2lkdGgiLCBmaWx0ZXJ3aWR0aCwNCgkJCQkic2FtcGxlcyIsIHNhbXBsZXMgKTsNCgkJfQ0KDQogICAgICAgIGV4dGVybiBmbG9hdCBfXzNkZm1fc2hhZG93aW5nOw0KICAgICAgICBfXzNkZm1fc2hhZG93aW5nID0gbHVtaW5hbmNlKENzaGFkKTsNCg0KCQlsY29sb3IgPSBtaXgoIGxjb2xvciwgaV9zaGFkb3dDb2xvciwgQ3NoYWQgKTsNCgl9DQoNCglyZXR1cm4gbGNvbG9yOw0KfQ0KDQoNCg0KDQoNCg0KDQoNCg0KI2xpbmUgOTEgIi4uL3JzbC9saWdodF91dGlscy5oIg0KY29sb3IgY29tcHV0ZVJ0U2hhZG93aW5nKA0KCWNvbG9yIGlfQ2w7DQoJY29sb3IgaV9zaGFkb3dDb2xvcjsNCgl1bmlmb3JtIGZsb2F0IGlfcnRTaGFkU2FtcGxlczsNCgl1bmlmb3JtIGZsb2F0IGlfcnRTaGFkTGlnaHRJc0RpcmVjdGlvbmFsOw0KCXVuaWZvcm0gZmxvYXQgaV9ydFNoYWRMaWdodFJhZGl1c09yQW5nbGU7DQoJdW5pZm9ybSBzdHJpbmcgaV9ydFNoYWRTdWJzZXQ7DQoJKQ0Kew0KCWV4dGVybiBwb2ludCBQczsNCg0KCWNvbG9yIGxjb2xvciA9IGlfQ2w7DQoNCglpZiggaV9ydFNoYWRTYW1wbGVzICE9IDAgJiYgMSA9PSByZWNlaXZlX3NoYWRvd3MoKSApDQoJew0KCQlwb2ludCB0bzsNCgkJZmxvYXQgYW5nbGU7DQoNCgkJaWYoIGlfcnRTaGFkTGlnaHRJc0RpcmVjdGlvbmFsID09IDEuMCApDQoJCXsNCgkJCXRvID0gUHMgKyAodmVjdG9yICJzaGFkZXIiICgwLDAsLTEpKSAqIDFlMTA7DQoJCQlhbmdsZSA9IHJhZGlhbnMoaV9ydFNoYWRMaWdodFJhZGl1c09yQW5nbGUpOw0KCQl9IA0KCQllbHNlIA0KCQl7DQoJCQl0byA9IHBvaW50ICJzaGFkZXIiIDA7DQoJCQlhbmdsZSA9IGF0YW4oIGlfcnRTaGFkTGlnaHRSYWRpdXNPckFuZ2xlIC8gZGlzdGFuY2UoIFBzLCB0byApICk7DQoJCX0NCg0KCQl1bmlmb3JtIGZsb2F0IGlzX2Jha2VwYXNzID0gMDsNCgkJb3B0aW9uKCJ1c2VyOm1heWFfYmFrZXBhc3MiLCBpc19iYWtlcGFzcyk7DQoJCXVuaWZvcm0gZmxvYXQgc2FtcGxlczsNCgkJaWYoaXNfYmFrZXBhc3M9PTEpDQoJCXsNCg0KDQoNCiNsaW5lIDEyOCAiLi4vcnNsL2xpZ2h0X3V0aWxzLmgiDQoJCQlzYW1wbGVzID0gY2VpbCggaV9ydFNoYWRTYW1wbGVzLzggKTsNCgkJfQ0KCQllbHNlDQoJCXsNCgkJCXNhbXBsZXMgPSBpX3J0U2hhZFNhbXBsZXM7DQoJCX0NCg0KCQljb2xvciBDdHJhbnNtaXNzaW9uID0gMC4wOw0KDQoNCg0KDQoNCg0KDQoNCg0KCQlDdHJhbnNtaXNzaW9uID0NCgkJCXRyYW5zbWlzc2lvbigNCgkJCQlQcywgdG8sDQoJCQkJInNhbXBsZXMiLCBzYW1wbGVzLA0KCQkJCSJzYW1wbGVjb25lIiwgYW5nbGUsDQoJCQkJImhpdHNpZGVzIiwgInJldmVyc2VkIiwNCgkJCQkic3Vic2V0IiwgaV9ydFNoYWRTdWJzZXQpOw0KDQoNCgkJY29sb3IgQ3NoYWQgPSAxLjAgLSBDdHJhbnNtaXNzaW9uOw0KDQoJCWV4dGVybiBmbG9hdCBfXzNkZm1fc2hhZG93aW5nOw0KCQlfXzNkZm1fc2hhZG93aW5nID0gbHVtaW5hbmNlKENzaGFkKTsNCg0KCQlsY29sb3IgPSBtaXgoIGlfQ2wsIGlfc2hhZG93Q29sb3IsIENzaGFkICk7DQoJfQ0KDQoJcmV0dXJuIGxjb2xvcjsNCn0NCg0KDQojbGluZSAxMCAibWF5YV9naV9saWdodC5zbCINCg0KDQoNCiNsaW5lIDIyICJtYXlhX2dpX2xpZ2h0LnNsIg0KbGlnaHQgbWF5YV9naV9saWdodCgNCg0KDQojbGluZSAyNSAibWF5YV9naV9saWdodC5zbCINCglmbG9hdCBlZmZlY3QgPSAxOw0KDQoNCg0KCWZsb2F0IGNvbG9yX2JsZWVkaW5nX2ludGVuc2l0eSA9IDEuMDsNCgljb2xvciBibGFja19wb2ludCA9IDAuMDsNCgljb2xvciB3aGl0ZV9wb2ludCA9IDAuMDsNCglmbG9hdCBzYW1wbGVzID0gNjQ7DQoJZmxvYXQgbWF4ZGlzdCA9IDFlMzY7DQoJc3RyaW5nIGRpc3RyaWJ1dGlvbiA9ICJjb3NpbmUiOw0KCXN0cmluZyBlbnZtYXAgPSAiIiwgZW52c3BhY2UgPSAid29ybGQiOw0KCWZsb2F0IGZhbGxvZmZtb2RlID0gMDsNCglmbG9hdCBmYWxsb2ZmID0gMTsNCg0KDQoJZmxvYXQgZW52aXJvbm1lbnRfaW50ZW5zaXR5ID0gMS4wOw0KCWNvbG9yIGVudmlyb25tZW50X2NvbG9yX2dhaW4gPSAxOw0KCWNvbG9yIGVudmlyb25tZW50X2NvbG9yX29mZnNldCA9IDA7DQoNCglmbG9hdCBlbnZpcm9ubWVudF9jYXN0c19zaGFkb3dzID0gMDsNCg0KCWZsb2F0IG9ubHlfYW92cyA9IDAuMDsNCg0KCXVuaWZvcm0gZmxvYXQgcG9pbnRfYmFzZWRfYmlhcyA9IDAuMDAxOw0KDQoNCg0KDQoNCiNsaW5lIDU0ICJtYXlhX2dpX2xpZ2h0LnNsIg0KCXVuaWZvcm0gZmxvYXQgdXNlX2RlcHJlY2F0ZWRfZ2kgPSAwOw0KDQoJZmxvYXQgX19ub25kaWZmdXNlID0gMDsNCglmbG9hdCBfX25vbnNwZWN1bGFyID0gMTsNCg0KCXN0cmluZyBfX2NhdGVnb3J5ID0gIiI7DQoNCg0KCW91dHB1dCB2YXJ5aW5nIGZsb2F0IF9fM2RmbV9zaGFkb3dpbmcgPSAwOw0KDQoJb3V0cHV0IHZhcnlpbmcgY29sb3IgX18zZGZtX3Vuc2hhZG93ZWRfY2wgPSAwOw0KDQoNCg0KDQoJb3V0cHV0IHZhcnlpbmcgZmxvYXQgX19vY2NsdXNpb24gPSAwOw0KDQoNCglvdXRwdXQgdmFyeWluZyBjb2xvciBfX3Zpc2liaWxpdHkgPSAxOw0KDQoNCglvdXRwdXQgdmFyeWluZyBjb2xvciBfX2Vudmlyb25tZW50X2RpZmZ1c2UgPSAwOw0KDQoNCglvdXRwdXQgdmFyeWluZyBjb2xvciBfX2NvbG9yX2JsZWVkaW5nID0gMDsgKQ0Kew0KCXVuaWZvcm0gc3RyaW5nIHJheXR5cGU9IiI7DQoJcmF5aW5mbyggInR5cGUiLCByYXl0eXBlICk7DQoNCglpZiggZWZmZWN0ID09IDAgKQ0KCXsNCgkJQ2wgPSAwOw0KCX0NCgllbHNlIGlmKCByYXl0eXBlID09ICJsaWdodCIgKQ0KCXsNCgkJaWYgKGVmZmVjdCA+PSAyICYmIA0KCQkJZW52bWFwICE9ICIiICYmIA0KCQkJZW52aXJvbm1lbnRfaW50ZW5zaXR5ID4gMCkNCgkJew0KDQoNCg0KDQoNCiNsaW5lIDk4ICJtYXlhX2dpX2xpZ2h0LnNsIg0KCQkJdW5pZm9ybSBzdHJpbmcgZ2F0aGVyX2NhdCA9IGNvbmNhdCgiZW52aXJvbm1lbnQ6IiwgZW52bWFwKTsNCgkJCXZlY3RvciBlbnZkaXIgPSAwOw0KCQkJY29sb3IgZW52Y29sb3IgPSAwOw0KCQkJZmxvYXQgc29saWRhbmdsZSA9IDA7DQoNCgkJCWdhdGhlcigNCgkJCQlnYXRoZXJfY2F0LCAwLCAwLCAwLCBzYW1wbGVzLA0KCQkJCSJlbnZpcm9ubWVudDpjb2xvciIsIGVudmNvbG9yLA0KCQkJCSJlbnZpcm9ubWVudDpkaXJlY3Rpb24iLCBlbnZkaXIsDQoJCQkJImVudmlyb25tZW50OnNvbGlkYW5nbGUiLCBzb2xpZGFuZ2xlICkNCgkJCXsNCgkJCQllbnZkaXIgPSB2dHJhbnNmb3JtKCBlbnZzcGFjZSwgImN1cnJlbnQiLCBlbnZkaXIgKTsNCg0KDQoJCQkJc29sYXIoIC1lbnZkaXIsIGFjb3MoIDEtc29saWRhbmdsZS8oMipQSSkgKSkNCgkJCQl7DQoJCQkJCUNsID0gZW52Y29sb3IgKiBlbnZpcm9ubWVudF9jb2xvcl9nYWluICsgZW52aXJvbm1lbnRfY29sb3Jfb2Zmc2V0Ow0KCQkJCQlDbCAqPSBlbnZpcm9ubWVudF9pbnRlbnNpdHkgLyAoNCpQSSk7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2UNCgl7DQoJCUNsID0gMDsNCgkJX19vY2NsdXNpb24gPSAwOw0KCQlfX3Zpc2liaWxpdHkgPSAxOw0KCQlfX2Vudmlyb25tZW50X2RpZmZ1c2UgPSAwOw0KCQlfX2NvbG9yX2JsZWVkaW5nID0gMDsNCg0KCQlub3JtYWwgTm4gPSBub3JtYWxpemUoTnMpOw0KCQlub3JtYWwgc2hhZGluZ19ub3JtYWwgPSBTaGFkaW5nTm9ybWFsKCBObiApOw0KDQoJCXVuaWZvcm0gc3RyaW5nIEQgPSBkaXN0cmlidXRpb247DQoJCWlmKCBlbnZtYXAgIT0gIiIgJiYgZWZmZWN0ID09IDMgJiYgZW52aXJvbm1lbnRfY2FzdHNfc2hhZG93cyAhPSAwICkNCgkJew0KCQkJRCA9IGVudm1hcDsNCgkJfQ0KDQoNCgkJdW5pZm9ybSBzdHJpbmcgYmFrZV9maWxlID0gIiI7DQoJCXVuaWZvcm0gZmxvYXQgbWF4c29saWRhbmdsZSA9IDAuMDE7DQoJCW9wdGlvbiggInVzZXI6YmFrZV9maWxlIiwgYmFrZV9maWxlICk7DQoJCW9wdGlvbiggInVzZXI6bWF5YV9wdGNfbWF4c29saWRhbmdsZSIsIG1heHNvbGlkYW5nbGUgKTsNCg0KCQlpbGx1bWluYXRlKCBQcyArIHNoYWRpbmdfbm9ybWFsICkNCgkJew0KCQkJaWYoIGVmZmVjdCA9PSA2NTUzNCApDQoJCQl7DQoNCg0KCQkJCXN0cmluZyBwaG90b25tYXAgPSAiIjsNCgkJCQlhdHRyaWJ1dGUoInBob3RvbjpnbG9iYWxtYXAiLCBwaG90b25tYXApOw0KDQoJCQkJaWYocGhvdG9ubWFwICE9ICIiKQ0KCQkJCXsNCgkJCQkJQ2wgPSBwaG90b25tYXAoIHBob3Rvbm1hcCwgUHMsIE5uLCAibWluZGVwdGgiLCAxKTsNCgkJCQl9DQoJCQkJZWxzZQ0KCQkJCXsNCgkJCQkJQ2wgPSAwOw0KCQkJCX0NCgkJCX0NCgkJCWVsc2UgaWYoIGVmZmVjdCA9PSAxICkNCgkJCXsNCg0KDQoJCQkJX19vY2NsdXNpb24gPSBvY2NsdXNpb24oDQoJCQkJCQlQcywgc2hhZGluZ19ub3JtYWwsIHNhbXBsZXMsIA0KCQkJCQkJIm1heGRpc3QiLCBtYXhkaXN0LA0KCQkJCQkJImFkYXB0aXZlIiwgMSwNCgkJCQkJCSJlbnZpcm9ubWVudHNwYWNlIiwgZW52c3BhY2UsIA0KCQkJCQkJImRpc3RyaWJ1dGlvbiIsIEQsDQoJCQkJCQkiZmFsbG9mZm1vZGUiLCBmYWxsb2ZmbW9kZSwgImZhbGxvZmYiLCBmYWxsb2ZmICk7DQoNCgkJCQlfX3Zpc2liaWxpdHkgPSAoMSAtIF9fb2NjbHVzaW9uKTsgICAgICANCgkJCQlfX3Zpc2liaWxpdHkgPSBtaXgoIGJsYWNrX3BvaW50LCB3aGl0ZV9wb2ludCwgX192aXNpYmlsaXR5ICk7DQoNCgkJCQlpZiggb25seV9hb3ZzIDw9IDAgKQ0KCQkJCXsNCgkJCQkJaWYgKCB1c2VfZGVwcmVjYXRlZF9naSA+IDAgKQ0KCQkJCQl7DQoJCQkJCQlfXzNkZm1fdW5zaGFkb3dlZF9jbCA9IHdoaXRlX3BvaW50Ow0KCQkJCQkJX18zZGZtX3NoYWRvd2luZyA9IGx1bWluYW5jZSgxIC0gX192aXNpYmlsaXR5KTsNCgkJCQkJfQ0KCQkJCQllbHNlDQoJCQkJCXsNCg0KCQkJCQkJQ2wgPSBfXzNkZm1fdW5zaGFkb3dlZF9jbCA9IF9fdmlzaWJpbGl0eTsNCgkJCQkJfQ0KCQkJCX0NCgkJCX0NCgkJCWVsc2UgaWYoIGVmZmVjdCA9PSAyICkNCgkJCXsNCgkJCQlpZiggZW52bWFwICE9ICIiICkNCgkJCQl7DQoNCg0KDQoNCg0KDQoNCg0KDQoNCiNsaW5lIDIwNCAibWF5YV9naV9saWdodC5zbCINCgkJCQkJdmVjdG9yIGVudnNwYWNlX05zID0NCgkJCQkJCXZ0cmFuc2Zvcm0oImN1cnJlbnQiLCBlbnZzcGFjZSwgc2hhZGluZ19ub3JtYWwpOw0KDQoJCQkJCV9fZW52aXJvbm1lbnRfZGlmZnVzZSA9DQoJCQkJCQllbnZpcm9ubWVudF9jb2xvcl9nYWluICogDQoJCQkJCQlpbmRpcmVjdGRpZmZ1c2UoIGVudm1hcCwgZW52c3BhY2VfTnMgKTsNCg0KCQkJCQlfX2Vudmlyb25tZW50X2RpZmZ1c2UgKz0gZW52aXJvbm1lbnRfY29sb3Jfb2Zmc2V0Ow0KDQoJCQkJCV9fZW52aXJvbm1lbnRfZGlmZnVzZSAqPSBlbnZpcm9ubWVudF9pbnRlbnNpdHkgLyBQSTsNCg0KCQkJCQlpZiggb25seV9hb3ZzIDw9IDAgKQ0KCQkJCQl7DQoJCQkJCQlfXzNkZm1fdW5zaGFkb3dlZF9jbCA9IF9fZW52aXJvbm1lbnRfZGlmZnVzZTsNCgkJCQkJCUNsID0gX19lbnZpcm9ubWVudF9kaWZmdXNlOw0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQkJZWxzZQ0KCQkJew0KDQoJCQkJaWYoIGNvbG9yX2JsZWVkaW5nX2ludGVuc2l0eSA+IDAgKQ0KCQkJCXsNCgkJCQkJZmxvYXQgb2NjID0gMDsNCgkJCQkJY29sb3IgZW52X2NvbG9yID0gMDsNCg0KCQkJCQljb2xvciBpbmRpcmVjdF9kaWZmdXNlOw0KCQkJCQlpZiggZWZmZWN0ID09IDQgKQ0KCQkJCQl7DQoNCgkJCQkJCWluZGlyZWN0X2RpZmZ1c2UgPSBpbmRpcmVjdGRpZmZ1c2UoDQoJCQkJCQkJUHMsIHNoYWRpbmdfbm9ybWFsLCAwLA0KCQkJCQkJCSJtYXhkaXN0IiwgbWF4ZGlzdCwNCgkJCQkJCQkicG9pbnRiYXNlZCIsIDEsDQoJCQkJCQkJImNsYW1wIiwgMSwgDQoJCQkJCQkJImZpbGVuYW1lIiwgYmFrZV9maWxlLA0KCQkJCQkJCSJjb29yZHN5c3RlbSIsICJ3b3JsZCIsDQoJCQkJCQkJImNvbmVhbmdsZSIsIFBJICogMC41LA0KCQkJCQkJCSJzb3J0YmxlZWRpbmciLCAxLA0KCQkJCQkJCSJoaXRzaWRlcyIsICJib3RoIiwNCgkJCQkJCQkibWF4c29saWRhbmdsZSIsIG1heHNvbGlkYW5nbGUsDQoJCQkJCQkJImJpYXMiLCBwb2ludF9iYXNlZF9iaWFzLA0KCQkJCQkJCSJvY2NsdXNpb24iLCBvY2MsDQoJCQkJCQkJImVudmlyb25tZW50c3BhY2UiLCBlbnZzcGFjZSwNCgkJCQkJCQkiZW52aXJvbm1lbnRtYXAiLCBlbnZtYXAsDQoJCQkJCQkJImVudmlyb25tZW50Y29sb3IiLCBlbnZfY29sb3IpOw0KCQkJCQl9DQoJCQkJCWVsc2UNCgkJCQkJew0KCQkJCQkJaWYoIHVzZV9kZXByZWNhdGVkX2dpID4gMCApDQoJCQkJCQl7DQoJCQkJCQkJaW5kaXJlY3RfZGlmZnVzZSA9IGluZGlyZWN0ZGlmZnVzZSgNCgkJCQkJCQkJUHMsIHNoYWRpbmdfbm9ybWFsLCBzYW1wbGVzLA0KCQkJCQkJCQkibWF4ZGlzdCIsIG1heGRpc3QsDQoJCQkJCQkJCSJkaXN0cmlidXRpb24iLCBELA0KCQkJCQkJCQkiZmFsbG9mZm1vZGUiLCBmYWxsb2ZmbW9kZSwNCgkJCQkJCQkJImZhbGxvZmYiLCBmYWxsb2ZmLA0KCQkJCQkJCQkib2NjbHVzaW9uIiwgb2NjLA0KCQkJCQkJCQkiZW52aXJvbm1lbnRzcGFjZSIsIGVudnNwYWNlLA0KCQkJCQkJCQkiZW52aXJvbm1lbnRtYXAiLCBlbnZtYXAsDQoJCQkJCQkJCSJlbnZpcm9ubWVudGNvbG9yIiwgZW52X2NvbG9yKTsNCgkJCQkJCX0NCgkJCQkJCWVsc2UNCgkJCQkJCXsNCg0KDQoNCg0KDQojbGluZSAyNzMgIm1heWFfZ2lfbGlnaHQuc2wiDQoJCQkJCQkJY29sb3IgdHJzOw0KCQkJCQkJCWluZGlyZWN0X2RpZmZ1c2UgPSB0cmFjZSgNCgkJCQkJCQkJUHMsIHNoYWRpbmdfbm9ybWFsLA0KCQkJCQkJCQkicmF5dHlwZSIsICJkaWZmdXNlIiwNCgkJCQkJCQkJInNhbXBsZXMiLCBzYW1wbGVzLA0KCQkJCQkJCQkiYnNkZiIsICJjb3NpbmUiLA0KCQkJCQkJCQkidHJhbnNtaXNzaW9uIiwgX192aXNpYmlsaXR5LA0KCQkJCQkJCQkibWF4ZGlzdCIsIG1heGRpc3QsDQoJCQkJCQkJCSJlbnZpcm9ubWVudDp0aW50IiwgZW52aXJvbm1lbnRfY29sb3JfZ2FpbiAqIGVudmlyb25tZW50X2ludGVuc2l0eSwNCgkJCQkJCQkJImVudmlyb25tZW50OnNwYWNlIiwgZW52c3BhY2UsDQoJCQkJCQkJCSJlbnZpcm9ubWVudDptYXAiLCBlbnZtYXAsDQoJCQkJCQkJCSJlbnZpcm9ubWVudGNvbnRyaWJ1dGlvbiIsIF9fZW52aXJvbm1lbnRfZGlmZnVzZSApOw0KDQoJCQkJCQkJX19jb2xvcl9ibGVlZGluZyA9IGluZGlyZWN0X2RpZmZ1c2UgLSBfX2Vudmlyb25tZW50X2RpZmZ1c2U7DQoJCQkJCQkJX19vY2NsdXNpb24gPSAxIC0gKF9fdmlzaWJpbGl0eVswXStfX3Zpc2liaWxpdHlbMV0rX192aXNpYmlsaXR5WzJdKS8zOyANCgkJCQkJCQlfX3Zpc2liaWxpdHkgPSBtaXgoIGJsYWNrX3BvaW50LCB3aGl0ZV9wb2ludCwgX192aXNpYmlsaXR5ICk7DQoJCQkJCQl9DQoJCQkJCX0NCg0KCQkJCQlpZiggdXNlX2RlcHJlY2F0ZWRfZ2k+MCB8fCBlZmZlY3Q9PTQgKQ0KCQkJCQl7IA0KCQkJCQkJX19jb2xvcl9ibGVlZGluZyA9IGluZGlyZWN0X2RpZmZ1c2UgLSBlbnZfY29sb3I7DQoJCQkJCQlfX2NvbG9yX2JsZWVkaW5nICo9IGNvbG9yX2JsZWVkaW5nX2ludGVuc2l0eTsNCg0KCQkJCQkJX19vY2NsdXNpb24gPSBvY2M7DQoNCgkJCQkJCV9fZW52aXJvbm1lbnRfZGlmZnVzZSA9IA0KCQkJCQkJCWVudmlyb25tZW50X2NvbG9yX2dhaW4gKiBlbnZfY29sb3IgKyBlbnZpcm9ubWVudF9jb2xvcl9vZmZzZXQ7DQoJCQkJCQlfX2Vudmlyb25tZW50X2RpZmZ1c2UgKj0gZW52aXJvbm1lbnRfaW50ZW5zaXR5Ow0KDQoJCQkJCQlfX3Zpc2liaWxpdHkgPSAoMSAtIF9fb2NjbHVzaW9uKTsNCgkJCQkJCV9fdmlzaWJpbGl0eSA9IG1peCggYmxhY2tfcG9pbnQsIHdoaXRlX3BvaW50LCBfX3Zpc2liaWxpdHkgKTsNCgkJCQkJfQ0KDQoJCQkJCWlmKCBvbmx5X2FvdnMgPD0gMCApDQoJCQkJCXsNCgkJCQkJCWlmICggdXNlX2RlcHJlY2F0ZWRfZ2kgPiAwICkNCgkJCQkJCXsNCgkJCQkJCQlfXzNkZm1fdW5zaGFkb3dlZF9jbCA9IF9fZW52aXJvbm1lbnRfZGlmZnVzZTsNCgkJCQkJCQlfXzNkZm1fc2hhZG93aW5nID0gbHVtaW5hbmNlKDEgLSBfX3Zpc2liaWxpdHkpOw0KCQkJCQkJCUNsID0gX19lbnZpcm9ubWVudF9kaWZmdXNlOw0KCQkJCQkJfQ0KCQkJCQkJZWxzZQ0KCQkJCQkJew0KCQkJCQkJCUNsID0gX18zZGZtX3Vuc2hhZG93ZWRfY2wgPQ0KCQkJCQkJCQlfX2Vudmlyb25tZW50X2RpZmZ1c2UgKyBfX2NvbG9yX2JsZWVkaW5nOw0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KfQ0K"
%comment-user 7 121
0

